## Валидация элементов формы с помощью Validation API

Валидация данных, вводимых пользователем в формы, - важный аспект разработки веб-приложений. Правильная валидация предотвращает отправку некорректных данных на сервер, что повышает безопасность и надежность приложения. В JavaScript существует встроенный механизм валидации - Validation API, который упрощает процесс проверки данных и предоставляет удобные инструменты для взаимодействия с пользователем.

### Основные возможности Validation API

* **Встроенные правила валидации:** API предоставляет набор готовых правил для проверки распространенных типов данных, таких как email, URL, числовые значения и др. 
* **Пользовательские сообщения об ошибках:**  Вы можете гибко настраивать сообщения об ошибках, отображаемые пользователю, делая их более информативными и понятными.
* **Кастомные правила валидации:**  API позволяет создавать собственные правила валидации для обработки специфических требований к данным.
* **Интеграция с CSS:**  Валидация данных тесно интегрирована с CSS, что позволяет визуально выделять некорректные поля формы и отображать сообщения об ошибках.

### Использование Validation API

Рассмотрим основные шаги по использованию Validation API для валидации формы:

1. **Определение правил валидации в HTML:**

   Атрибуты валидации в HTML5 позволяют задавать правила проверки данных непосредственно в разметке формы. Некоторые из наиболее часто используемых атрибутов:

    | Атрибут | Описание |
    |---|---|
    | `required` | Поле обязательно для заполнения |
    | `minlength` | Минимальная длина значения поля |
    | `maxlength` | Максимальная длина значения поля |
    | `pattern` | Регулярное выражение, которому должно соответствовать значение поля |
    | `type="email"` | Проверка на корректность адреса электронной почты |
    | `type="url"` | Проверка на корректность URL-адреса |

   Пример:

   ```html
   <form>
     <label for="email">Email:</label>
     <input type="email" id="email" name="email" required>

     <label for="password">Пароль:</label>
     <input type="password" id="password" name="password" required minlength="8">

     <button type="submit">Отправить</button>
   </form>
   ```

   В этом примере поля "Email" и "Пароль" обязательны для заполнения. Поле "Пароль" также должно содержать не менее 8 символов.

2. **Доступ к объекту валидации:**

   Для доступа к функционалу Validation API используется свойство `validity` объекта `HTMLInputElement`. 
   ```javascript
    const form = document.querySelector('form');
    const emailInput = document.getElementById('email');

    form.addEventListener('submit', (event) => {
      event.preventDefault(); // предотвращаем отправку формы по умолчанию

      if (!emailInput.validity.valid) {
        //  Проверка на валидность поля email
        console.log("Поле email заполнено некорректно.");
        return; 
      }
    }); 
   ```

3. **Проверка статуса валидации:**

   Объект `validity` содержит ряд свойств, позволяющих определить, является ли значение поля валидным:

   ```javascript
   emailInput.validity.valid; // true, если значение валидно, иначе false
   emailInput.validity.valueMissing; // true, если поле обязательно и не заполнено
   emailInput.validity.tooShort; // true, если длина значения меньше минимальной
   emailInput.validity.tooLong; // true, если длина значения превышает максимальную
   emailInput.validity.patternMismatch; // true, если значение не соответствует заданному шаблону
   emailInput.validity.typeMismatch; // true, если тип значения не соответствует типу поля (например, email)
   ```

4. **Отображение сообщений об ошибках:**

   Validation API не предоставляет встроенных механизмов отображения сообщений об ошибках, но вы можете реализовать их самостоятельно с помощью JavaScript и CSS. Например:

   ```javascript
   const emailError = document.createElement('div'); 
   emailInput.parentNode.insertBefore(emailError, emailInput.nextSibling);

   form.addEventListener('submit', (event) => {
     event.preventDefault(); 

     if (!emailInput.validity.valid) {
       emailError.textContent = 'Пожалуйста, введите корректный email адрес.';
       emailError.style.color = 'red'; 
       return; 
     } else {
       emailError.textContent = ''; 
     }

     // ... дальнейшая обработка формы ...
   });
   ```

5. **Создание кастомных правил валидации:**

    Для создания собственных правил валидации используется метод `setCustomValidity()` объекта `HTMLInputElement`. 

    Пример: 

    ```javascript
    const passwordInput = document.getElementById('password');

    passwordInput.addEventListener('input', () => {
      if (passwordInput.value.length < 8) {
        passwordInput.setCustomValidity('Пароль должен содержать не менее 8 символов.');
      } else {
        passwordInput.setCustomValidity(''); // Сбрасываем сообщение об ошибке, если пароль валиден
      }
    });
    ```

   В этом примере мы проверяем длину пароля при каждом изменении значения поля и устанавливаем кастомное сообщение об ошибке, если пароль слишком короткий.

### Заключение

Validation API предоставляет мощный и гибкий инструмент для валидации данных форм. Используя встроенные и кастомные правила валидации, вы можете создавать удобные и безопасные формы, которые улучшают пользовательский опыт и предотвращают ошибки при обработке данных на сервере. 
