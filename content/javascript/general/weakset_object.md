## WeakSet

В JavaScript, `WeakSet` — это структура данных, которая позволяет хранить коллекцию объектов без возможности их перечисления. В отличие от `Set`, который хранит сильные ссылки на свои элементы, `WeakSet` хранит слабые ссылки. Это означает, что если объект больше не используется нигде в коде, кроме как в `WeakSet`, то сборщик мусора может удалить его из памяти. 

### Основные характеристики WeakSet:

- **Хранение только объектов:** В `WeakSet` можно добавлять только объекты. Примитивные типы данных, такие как числа, строки, булевы значения, не поддерживаются. 
- **Отсутствие итерации:** `WeakSet` не предоставляет методов для итерации по своим элементам.  Вы не можете получить доступ к списку всех объектов, хранящихся в `WeakSet`.
- **Слабые ссылки:**  `WeakSet` хранит слабые ссылки на объекты. Это означает, что наличие объекта в `WeakSet` не предотвращает его сборку мусором, если на него больше нет сильных ссылок.

### Создание WeakSet

Для создания нового `WeakSet` используйте конструктор `WeakSet()`:

```javascript
const weakSet = new WeakSet();
```

Вы можете сразу добавить объекты в `WeakSet` при его создании, передав массив объектов в конструктор:

```javascript
const object1 = { name: 'Object 1' };
const object2 = { name: 'Object 2' };

const weakSet = new WeakSet([object1, object2]);
```

### Методы WeakSet

`WeakSet` предоставляет три основных метода:

- `add(value)`: Добавляет объект `value` в `WeakSet`. Возвращает сам `WeakSet`.

```javascript
const weakSet = new WeakSet();
const object1 = { name: 'Object 1' };

weakSet.add(object1); // Добавляем object1 в WeakSet
```

- `delete(value)`: Удаляет объект `value` из `WeakSet`.  Возвращает `true`, если объект был удален, и `false`, если его не было в `WeakSet`.

```javascript
weakSet.delete(object1); // Удаляем object1 из WeakSet
```

- `has(value)`: Проверяет, содержится ли объект `value` в `WeakSet`. Возвращает `true`, если объект присутствует, и `false` в противном случае.

```javascript
weakSet.has(object1); // Проверяем, есть ли object1 в WeakSet
```

### Применение WeakSet

`WeakSet` полезен в сценариях, где вам нужно отслеживать набор объектов, не влияя на их жизненный цикл в памяти. Вот несколько примеров использования `WeakSet`:

**1. Кэширование:**

`WeakSet` может использоваться для хранения объектов в кэше. Если объект больше не используется в других частях кода, сборщик мусора может удалить его из памяти, а `WeakSet` автоматически удалит ссылку на него. 

```javascript
const cache = new WeakSet();

function expensiveOperation(object) {
  if (cache.has(object)) {
    console.log('Результат взят из кэша');
    // Возвращаем результат из кэша
  } else {
    console.log('Вычисление результата...');
    // Выполняем ресурсоемкую операцию
    cache.add(object); // Добавляем объект в кэш
    // Возвращаем результат
  }
}
```

**2. Отслеживание DOM-элементов:**

`WeakSet` может использоваться для отслеживания DOM-элементов, которые были обработаны определенным образом. 

```javascript
const processedElements = new WeakSet();

function processElement(element) {
  if (processedElements.has(element)) {
    return; // Элемент уже обработан
  }

  // Обрабатываем элемент
  processedElements.add(element);
}
```

### Отличия WeakSet от Set

| Особенность      | WeakSet                      | Set                         |
|-----------------|-------------------------------|-----------------------------|
| Тип элементов     | Только объекты                | Любые                       |
| Итерация        | Не поддерживается           | Поддерживается             |
| Ссылки         | Слабые ссылки                 | Сильные ссылки              |
| Размер (`.size`) | Недоступен                  | Доступен                    |

**Важно помнить, что WeakSet не предоставляет механизмов для итерации или получения количества элементов. Это сделано для того, чтобы сборщик мусора мог свободно удалять объекты, на которые больше нет ссылок.** 
