## Работа с контроллерами

В разработке веб-приложений на Node.js контроллеры играют важную роль, обрабатывая входящие запросы от клиентов и определяя, какие действия следует предпринять. Они действуют как посредники между маршрутами, моделями данных и представлениями, обеспечивая логическое разделение задач и чистоту кода.

### Основные задачи контроллеров

1. **Обработка запросов:** Контроллеры получают запросы от клиентов, отправленные на определенные маршруты, и извлекают из них необходимую информацию, такую как параметры запроса, данные формы и заголовки.

2. **Вызов бизнес-логики:** После получения запроса контроллеры вызывают соответствующую бизнес-логику, которая может включать в себя валидацию данных, взаимодействие с базами данных, вычисления или другие операции.

3. **Формирование ответа:** После выполнения бизнес-логики контроллеры формируют ответ для клиента, который может быть в формате HTML, JSON, XML или другом.

### Создание простого контроллера

Рассмотрим пример простого контроллера для обработки запросов к API, возвращающего список пользователей:

```javascript
// ./controllers/users.js

// Функция для получения списка пользователей
const getUsers = (req, res) => {
  // Имитация получения данных из базы данных
  const users = [
    { id: 1, name: 'John Doe' },
    { id: 2, name: 'Jane Doe' },
  ];

  // Отправка ответа в формате JSON
  res.json(users);
};

// Экспорт функции для использования в других частях приложения
module.exports = {
  getUsers,
};
```

В этом примере мы определили функцию `getUsers`, которая принимает два аргумента: `req` (объект запроса) и `res` (объект ответа). Внутри функции мы имитируем получение списка пользователей из базы данных и отправляем его клиенту в формате JSON с помощью метода `res.json()`.

### Подключение контроллера к маршруту

Для того чтобы использовать созданный контроллер, необходимо подключить его к маршруту в файле конфигурации маршрутизатора:

```javascript
// ./routes/users.js

const express = require('express');
const router = express.Router();

// Импорт контроллера
const usersController = require('../controllers/users');

// Определение маршрута для получения списка пользователей
router.get('/', usersController.getUsers);

// Экспорт маршрутизатора для использования в главном файле приложения
module.exports = router;
```

В этом примере мы создаем новый маршрутизатор с помощью `express.Router()`, импортируем контроллер `usersController` и определяем маршрут для метода GET на корневом пути (`/`), который вызывает функцию `getUsers` из контроллера.

### Использование контроллера в главном файле приложения

```javascript
// ./index.js

const express = require('express');
const app = express();

// Импорт маршрутов
const usersRoutes = require('./routes/users');

// Подключение маршрутов
app.use('/users', usersRoutes);

// Запуск сервера
app.listen(3000, () => {
  console.log('Сервер запущен на порту 3000');
});
```

В этом примере мы подключаем маршрутизатор `usersRoutes` к пути `/users`, что означает, что все запросы, начинающиеся с `/users`, будут обрабатываться этим маршрутизатором.

### Преимущества использования контроллеров

- **Логическое разделение задач:** Контроллеры позволяют разделить логику обработки запросов от бизнес-логики и формирования ответов, что делает код более чистым, понятным и простым в поддержке.

- **Повторное использование кода:** Контроллеры можно легко использовать повторно в разных частях приложения, что сокращает дублирование кода и упрощает его изменение.

- **Улучшенная тестируемость:** Использование контроллеров упрощает написание модульных тестов для отдельных частей приложения, так как они имеют четко определенные входные и выходные данные.

### Заключение

Контроллеры являются важной частью разработки веб-приложений на Node.js, обеспечивая структурированный и организованный подход к обработке запросов. 
Использование контроллеров позволяет создавать более чистый, модульный и легко поддерживаемый код. 
