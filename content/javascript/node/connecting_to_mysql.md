## Подключение к MySQL

Node.js, будучи мощной платформой для разработки бэкенда, часто используется для создания приложений, взаимодействующих с базами данных. MySQL - одна из популярнейших систем управления базами данных, поэтому умение подключаться к ней из Node.js приложения критически важно.

### Выбор драйвера

Для взаимодействия Node.js с MySQL используется драйвер - библиотека, предоставляющая API для работы с базой данных. Один из наиболее популярных драйверов - `mysql2`. Он предлагает богатый функционал, высокую производительность и активную поддержку сообщества. 

### Установка

Перед началом работы установите драйвер `mysql2`  в ваш проект:

```bash
npm install mysql2
```

### Создание подключения

Первым шагом при работе с MySQL является создание подключения. 

```javascript
const mysql = require('mysql2');

// Создаем объект с настройками подключения
const connection = mysql.createConnection({
  host: 'localhost', // адрес сервера MySQL
  user: 'username', // имя пользователя
  password: 'password', // пароль
  database: 'database_name' // имя базы данных
});

// Подключаемся к базе данных
connection.connect((err) => {
  if (err) {
    console.error('Ошибка подключения: ' + err.stack);
    return;
  }
  console.log('Успешное подключение с ID ' + connection.threadId);
});
```

В этом коде:

- Подключаем модуль `mysql2`.
- Создаем объект `connection` с параметрами подключения к базе данных (host, user, password, database). 
- Вызываем метод `connect()`, чтобы установить соединение. В случае ошибки выводим сообщение в консоль.

### Выполнение запросов

После успешного подключения можно выполнять SQL запросы. 

**Пример запроса на выборку данных:**

```javascript
const sql = 'SELECT * FROM users';

connection.query(sql, (err, results) => {
  if (err) {
    console.error('Ошибка выполнения запроса: ' + err.stack);
    return;
  }
  console.log(results); 
});
```

В этом примере:

- Определяем SQL запрос на выборку всех данных из таблицы `users`.
- Вызываем метод `query()`, передавая ему запрос и callback-функцию для обработки результата.
- В callback-функции проверяем наличие ошибок.
- Выводим полученные данные в консоль.

**Пример запроса на добавление данных:**

```javascript
const sql = 'INSERT INTO users (name, email) VALUES (?, ?)';
const values = ['Иван', 'ivan@example.com'];

connection.query(sql, values, (err, result) => {
  if (err) {
    console.error('Ошибка выполнения запроса: ' + err.stack);
    return;
  }
  console.log('Добавлено строк: ' + result.affectedRows);
});
```

В этом примере:

- Формируем SQL запрос с плейсхолдерами (`?`) для подстановки значений.
- Создаем массив `values` со значениями для вставки.
- Вызываем `query()`, передавая запрос, массив значений и callback-функцию.
- В callback-функции проверяем ошибки и выводим количество добавленных строк.


### Закрытие подключения

После завершения работы с базой данных важно закрыть соединение.

```javascript
connection.end((err) => {
  if (err) {
    console.error('Ошибка закрытия соединения: ' + err.stack);
    return;
  }
  console.log('Соединение закрыто.');
});
```

### Обработка ошибок

Важно обрабатывать ошибки при работе с базой данных. В примерах выше ошибки выводятся в консоль, но в реальных приложениях их следует обрабатывать более изящно, например, логировать или отображать пользователю информативные сообщения об ошибках.

### Безопасность

При работе с базами данных всегда помните о безопасности. Никогда не храните пароли и другие конфиденциальные данные в коде. Используйте переменные окружения или специальные инструменты для хранения секретов.

### Заключение

В этой статье мы рассмотрели основы подключения к MySQL из Node.js приложения с помощью драйвера `mysql2`. Вы научились создавать подключение, выполнять SQL запросы, обрабатывать ошибки и закрывать соединение.  Помните, что это лишь базовые знания, и для создания полноценных приложений вам потребуется изучить больше информации о Node.js и MySQL.
