## Выполнение запросов к MySQL в Node.js

MySQL является одной из самых популярных систем управления базами данных (СУБД), используемых в веб-разработке. Node.js, будучи мощной платформой для создания серверных приложений, предоставляет возможность взаимодействия с MySQL посредством специальных модулей.

В этом разделе мы рассмотрим, как выполнять запросы к MySQL базе данных из Node.js приложения, используя модуль `mysql2`. 

### Установка модуля `mysql2`

Перед началом работы необходимо установить модуль `mysql2`. Для этого выполните следующую команду в терминале:

```bash
npm install mysql2
```

### Подключение к базе данных

Для выполнения запросов к базе данных необходимо установить соединение с ней. Модуль `mysql2` предоставляет для этого функцию `createConnection()`. Передайте ей объект с параметрами подключения, такими как хост, имя пользователя, пароль и название базы данных.

```javascript
// Импорт модуля mysql2
const mysql = require('mysql2');

// Создание объекта с параметрами подключения
const connection = mysql.createConnection({
  host: 'localhost',
  user: 'username',
  password: 'password',
  database: 'database_name'
});

// Подключение к базе данных
connection.connect((err) => {
  if (err) {
    console.error('Ошибка подключения к базе данных: ' + err.stack);
    return;
  }
  console.log('Подключение к базе данных успешно установлено с ID ' + connection.threadId);
});
```

В данном примере мы создаем объект `connection`, содержащий параметры подключения к базе данных. Функция `connect()` устанавливает соединение с базой данных. В случае возникновения ошибки, она будет выведена в консоль. 

### Выполнение запросов

После успешного подключения можно выполнять SQL запросы к базе данных. Модуль `mysql2` предоставляет для этого функцию `query()`.

#### Выполнение простого запроса

Следующий пример демонстрирует выполнение простого запроса `SELECT` для получения данных из таблицы `users`:

```javascript
// Выполнение запроса SELECT
connection.query('SELECT * FROM `users`', (err, results, fields) => {
  if (err) {
    console.error('Ошибка выполнения запроса: ' + err.stack);
    return;
  }
  // Обработка результатов запроса
  console.log(results); 
  // Вывод массива объектов, представляющих строки таблицы
});
```

В этом примере мы передаем SQL запрос `SELECT * FROM users` в функцию `query()`. В случае успешного выполнения запроса, переменная `results` будет содержать массив объектов, каждый из которых представляет собой строку из таблицы `users`. 

#### Выполнение запроса с параметрами

Для предотвращения SQL инъекций рекомендуется использовать параметризованные запросы. Модуль `mysql2` позволяет передавать параметры в запрос в виде массива.

```javascript
// Значение для параметра
const userId = 1;

// Выполнение запроса с параметром
connection.query('SELECT * FROM `users` WHERE `id` = ?', [userId], (err, results, fields) => {
  if (err) {
    console.error('Ошибка выполнения запроса: ' + err.stack);
    return;
  }
  // Обработка результатов запроса
  console.log(results);
  // Вывод массива объектов, представляющих строки таблицы, удовлетворяющие условию
});
```

В этом примере знак вопроса (`?`) в SQL запросе является placeholder-ом для параметра. Значение параметра передается вторым аргументом функции `query()` в виде массива.

### Закрытие соединения

После завершения работы с базой данных необходимо закрыть соединение. Для этого используется функция `end()`.

```javascript
// Закрытие соединения с базой данных
connection.end((err) => {
  if (err) {
    console.error('Ошибка закрытия соединения: ' + err.stack);
    return;
  }
  console.log('Соединение с базой данных закрыто.');
});
```

### Обработка ошибок

Важно обрабатывать ошибки при работе с базой данных. В примерах выше мы выводили сообщение об ошибке в консоль. В реальных приложениях рекомендуется использовать более продвинутые методы обработки ошибок, такие как логирование или отображение информативных сообщений пользователю.

### Заключение

В этом разделе мы рассмотрели основы выполнения запросов к MySQL базе данных из Node.js приложения с использованием модуля `mysql2`.  Модуль предоставляет богатый набор функций для работы с базой данных, включая выполнение транзакций, работу с пулами соединений и многое другое. 
