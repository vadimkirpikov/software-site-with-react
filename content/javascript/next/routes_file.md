## Определение маршрутов в файле `routes.js`

В версии Next.js 14.0.0 и выше вводится новый подход к определению маршрутов - файл `routes.js`. Этот файл позволяет централизованно управлять всеми маршрутами вашего приложения, делая код более структурированным и удобным в поддержке.

### Создание файла `routes.js`

Для начала создайте файл `routes.js` в корне вашего приложения Next.js. Этот файл будет служить точкой входа для определения всех ваших маршрутов.

```
// routes.js
```

### Определение базового маршрута

Для определения маршрута в файле `routes.js` используется функция `defineRoutes` из библиотеки `next/navigation`. Эта функция принимает массив объектов, каждый из которых описывает отдельный маршрут.

```javascript
// routes.js
import { defineRoutes } from 'next/navigation';

export default defineRoutes(() => [
  {
    path: '/',
    Component: () => <h1>Главная страница</h1>,
  },
]);
```

В данном примере мы определили маршрут для корневого пути `/`. При обращении к этому маршруту будет отображен заголовок `<h1>Главная страница</h1>`.

### Динамические сегменты

`routes.js` также поддерживает динамические сегменты в маршрутах. Для создания динамического сегмента используется синтаксис `[...slug]`.

```javascript
// routes.js
import { defineRoutes } from 'next/navigation';

export default defineRoutes(() => [
  // ... другие маршруты

  {
    path: '/blog/[...slug]',
    Component: ({ params }) => (
      <div>
        <h1>Страница блога</h1>
        <p>Slug: {params.slug.join('/')}</p>
      </div>
    ),
  },
]);
```

В данном примере мы определили маршрут `/blog/[...slug]`, который будет обрабатывать все запросы к страницам блога. Динамический сегмент `[...slug]` будет содержать все сегменты пути после `/blog/`. Например, запрос к `/blog/my-first-post` приведет к тому, что `params.slug` будет равен `['my-first-post']`.

### Вложенные маршруты

Для создания вложенных маршрутов достаточно определить их как дочерние элементы в массиве маршрутов.

```javascript
// routes.js
import { defineRoutes } from 'next/navigation';

export default defineRoutes(() => [
  // ... другие маршруты

  {
    path: '/dashboard',
    children: [
      {
        path: '/profile',
        Component: () => <h1>Профиль пользователя</h1>,
      },
      {
        path: '/settings',
        Component: () => <h1>Настройки пользователя</h1>,
      },
    ],
  },
]);
```

В данном примере мы определили два вложенных маршрута `/dashboard/profile` и `/dashboard/settings` внутри маршрута `/dashboard`.

### Перенаправления

Для создания перенаправления можно использовать свойство `redirect` в объекте маршрута.

```javascript
// routes.js
import { defineRoutes } from 'next/navigation';

export default defineRoutes(() => [
  // ... другие маршруты

  {
    path: '/old-blog',
    redirect: '/blog',
  },
]);
```

В данном примере при обращении к `/old-blog` пользователь будет перенаправлен на `/blog`.

### Ограничения маршрутов

Для задания ограничений на динамические сегменты можно использовать свойство `constraints` в объекте маршрута.

```javascript
// routes.js
import { defineRoutes } from 'next/navigation';

export default defineRoutes(() => [
  // ... другие маршруты

  {
    path: '/products/[id]',
    Component: ({ params }) => (
      <div>
        <h1>Страница продукта</h1>
        <p>ID продукта: {params.id}</p>
      </div>
    ),
    constraints: {
      id: /^[0-9]+$/, // ID продукта должен быть числом
    },
  },
]);
```

В данном примере мы определили ограничение на динамический сегмент `[id]`, указав, что он должен быть числом.

### Использование `routes.js` в компонентах

Для перехода по маршрутам, определенным в `routes.js`, можно использовать компонент `Link` из библиотеки `next/navigation`.

```javascript
// components/Navigation.js
'use client'; // Необходимо для использования Link

import Link from 'next/link';

export default function Navigation() {
  return (
    <nav>
      <ul>
        <li>
          <Link href="/">Главная</Link>
        </li>
        <li>
          <Link href="/blog">Блог</Link>
        </li>
      </ul>
    </nav>
  );
}
```

В данном примере мы создали компонент навигации, который использует компонент `Link` для перехода по маршрутам `/` и `/blog`.

### Заключение

Использование `routes.js` для определения маршрутов в Next.js 14.0.0 предоставляет удобный и централизованный способ управления всеми маршрутами вашего приложения. Динамические сегменты, вложенные маршруты, перенаправления и ограничения маршрутов делают этот подход гибким и мощным инструментом для разработки веб-приложений.
