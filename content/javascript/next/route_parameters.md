## Маршрутизация с параметрами в Next.js

Next.js предлагает мощную систему маршрутизации, позволяющую создавать динамические пути и извлекать данные из URL. Одним из ключевых аспектов этой системы является использование параметров маршрута, которые предоставляют возможность создавать гибкие и динамичные веб-приложения.

### Основы динамической маршрутизации

Динамическая маршрутизация позволяет создавать страницы, URL которых могут меняться в зависимости от определенных значений. В Next.js эта функциональность реализована с помощью именованных сегментов в пути к файлу.

**Создание динамического маршрута:**

1. **Создайте файл или папку в директории `app` с квадратными скобками в имени:**

```
app
└── products
    └── [id].js
```

В данном примере `[id].js` представляет собой файл страницы, который будет отображаться для любого URL, соответствующего шаблону `/products/что-угодно`. 

2. **Экспортируйте функцию `generateStaticParams` (для статической генерации) или `generateMetadata` (для генерации на стороне сервера) из файла страницы:**

```javascript
// app/products/[id].js
export async function generateStaticParams() {
  // Логика для получения данных о продуктах, 
  // например, из базы данных или API
  const products = await fetchProducts();

  return products.map((product) => ({
    id: product.id.toString(), // id должен быть строкой
  }));
}

export default function ProductPage({ params }) {
  // ...
}
```

Функция `generateStaticParams` возвращает массив объектов, каждый из которых содержит объект `params`. Этот объект будет передан в качестве props в компонент страницы.

3. **Получите доступ к параметрам маршрута в компоненте страницы:**

```javascript
// app/products/[id].js
// ...

export default function ProductPage({ params }) {
  const productId = params.id; 

  // ... логика для получения и отображения продукта по id
}
```

Внутри компонента страницы `params` доступен как свойство пропсов. Он содержит объект со всеми параметрами, извлеченными из URL. 

**Пример:**

Для URL `/products/123` значение `params.id` будет равно `123`. Next.js автоматически сопоставит сегмент URL `123` с параметром `id`, определенным в имени файла `[id].js`.

### Типы динамических маршрутов

Next.js поддерживает два основных типа динамических маршрутов:

* **Статическая генерация:** Страницы генерируются во время сборки и обслуживаются как статические HTML-файлы. Это подходит для контента, который не меняется часто, например, страницы блога.

* **Генерация на стороне сервера:** Страницы генерируются на сервере при каждом запросе. Используйте этот подход для контента, который должен быть динамическим, например, данные пользователя.

**Выбор типа маршрута:**

* Используйте статическую генерацию, если:
    * Содержимое страницы не меняется часто.
    * SEO важен для страницы.

* Используйте генерацию на стороне сервера, если:
    * Содержимое страницы меняется часто.
    * SEO не важен для страницы.

### Работа с несколькими параметрами

В маршруте можно использовать несколько параметров, разделенных символом `/`:

**Пример:**

```
app
└── blog
    └── [category]
        └── [slug].js
```

В этом примере `[category]` и `[slug]` — это динамические сегменты. URL `/blog/news/new-features` будет соответствовать этому маршруту, и в компоненте страницы `[slug].js` можно будет получить доступ к обоим параметрам:

```javascript
// app/blog/[category]/[slug].js
// ...

export default function BlogPostPage({ params }) {
  const { category, slug } = params; 

  // ... логика для получения и отображения поста по category и slug
}
```

### Важные моменты

* **Типы данных параметров:** Параметры маршрута всегда передаются как строки. Если требуется числовой тип, необходимо выполнить преобразование.

* **Обработка ошибок:** Важно обрабатывать случаи, когда запрошенный маршрут не существует или данные для него не найдены. Используйте `notFound()` для отображения страницы 404.

* **Вложенные маршруты:** Next.js позволяет создавать вложенные маршруты, что удобно для организации структуры сайта.

Маршрутизация с параметрами является важной частью разработки динамических веб-приложений. Next.js предоставляет простой и мощный API для создания гибких маршрутов, позволяя легко создавать сложные веб-приложения. 
