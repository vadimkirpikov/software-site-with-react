## Файл настроек Next.js

Next.js предоставляет гибкую конфигурацию с помощью файла `next.config.js`, расположенного в корне проекта. Этот файл позволяет вам настраивать различные аспекты приложения, такие как маршрутизация, оптимизация, интернационализация и многое другое. 

`next.config.js` — это обычный JavaScript-модуль, который экспортирует объект с опциями конфигурации. Давайте рассмотрим некоторые из наиболее распространенных опций.

### Базовая конфигурация

**1. Установка заголовков HTTP:**

Вы можете установить пользовательские заголовки HTTP для всех страниц вашего приложения.

```javascript
// next.config.js

module.exports = {
  async headers() {
    return [
      {
        // Сопоставление всех путей
        source: '/(.*)',
        headers: [
          { key: 'X-Custom-Header', value: 'My custom header value' },
        ],
      },
    ]
  },
};
```

В этом примере мы устанавливаем заголовок `X-Custom-Header` со значением `My custom header value` для всех запросов.

**2. Перенаправление:**

Перенаправление запросов с одного пути на другой.

```javascript
// next.config.js

module.exports = {
  async redirects() {
    return [
      {
        source: '/old-blog/:slug', // Старый путь
        destination: '/blog/:slug', // Новый путь
        permanent: true, // Постоянное перенаправление (301)
      },
    ]
  },
};
```

Здесь мы перенаправляем все запросы с пути `/old-blog/:slug` на `/blog/:slug`, используя постоянное перенаправление.

**3. Настройка Webpack:**

Next.js позволяет настраивать сборку Webpack с помощью опции `webpack`.

```javascript
// next.config.js

const path = require('path');

module.exports = {
  webpack: (config) => {
    config.resolve.alias['@components'] = path.join(__dirname, 'components');
    return config;
  },
};
```

В этом примере мы создаем псевдоним `@components` для папки `components` в нашем проекте.

**4. Настройка изображений:**

Next.js предоставляет встроенную оптимизацию изображений. Вы можете настроить ее с помощью опции `images`.

```javascript
// next.config.js

module.exports = {
  images: {
    domains: ['example.com'], // Домены, разрешенные для оптимизации
    formats: ['image/avif', 'image/webp'], // Поддерживаемые форматы изображений
  },
};
```

Здесь мы разрешаем оптимизацию изображений только с домена `example.com` и указываем поддерживаемые форматы.

### Расширенная конфигурация

**1. Интернационализация:**

Next.js поддерживает интернационализацию (i18n) через опцию `i18n`.

```javascript
// next.config.js

module.exports = {
  i18n: {
    locales: ['en', 'ru'], // Поддерживаемые локали
    defaultLocale: 'en', // Локаль по умолчанию
  },
};
```

Этот код настраивает приложение на поддержку английского (`en`) и русского (`ru`) языков.

**2. Серверные функции:**

Настройки для бессерверных функций, запускаемых на стороне сервера.

```javascript
// next.config.js

module.exports = {
  experimental: {
    serverActions: true, // Включение бессерверных функций
  },
};
```

В этом примере мы включаем экспериментальную функцию `serverActions`.

**3. Переменные окружения:**

Next.js позволяет вам безопасно использовать переменные окружения на стороне клиента.

```javascript
// next.config.js

module.exports = {
  env: {
    API_KEY: process.env.API_KEY, // Доступ к переменной окружения
  },
};
```

Здесь мы делаем переменную окружения `API_KEY` доступной на стороне клиента.

### Заключение

Это лишь некоторые из доступных опций конфигурации Next.js. Полный список опций и их подробное описание вы можете найти в [официальной документации Next.js](https://nextjs.org/docs). 

Конфигурирование вашего приложения с помощью `next.config.js` позволяет вам настроить его под ваши нужды, повысить производительность, улучшить SEO и многое другое.