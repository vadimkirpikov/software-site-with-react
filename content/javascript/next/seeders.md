## Создание сидеров в Next.js

Сидеры — это функции, которые выполняются на сервере при сборке приложения Next.js или в процессе разработки. 
Они позволяют выполнять важные задачи до того, как приложение станет доступным для пользователей. 

### Типичные сценарии использования сидеров:

- Загрузка данных из внешних API и сохранение их в базе данных.
- Создание начальных данных для приложения, таких как пользователи-администраторы или демонстрационные данные.
- Выполнение длительных вычислений, результаты которых нужны при рендеринге страниц.

### Создание и использование сидеров

**Шаг 1:** Создайте файл `seed.js` (или любое другое имя) в корне вашего проекта Next.js.

**Шаг 2:** Напишите код вашего сидера внутри этого файла.

```javascript
// seed.js

const mongoose = require('mongoose'); // Пример подключения к MongoDB

// Подключение к базе данных (замените на ваши данные)
mongoose.connect('mongodb://localhost:27017/mydatabase', {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});

// Модель данных (замените на вашу модель)
const Product = mongoose.model('Product', {
  name: String,
  price: Number,
});

async function seedProducts() {
  // Удаление существующих данных (по желанию)
  await Product.deleteMany({});

  // Создание новых данных
  await Product.create([
    { name: 'Product 1', price: 10 },
    { name: 'Product 2', price: 20 },
    { name: 'Product 3', price: 30 },
  ]);

  console.log('Данные успешно добавлены!');
}

// Запуск сидера
seedProducts()
  .then(() => {
    // Отключение от базы данных
    mongoose.connection.close();
  })
  .catch((error) => {
    console.error('Ошибка при добавлении данных:', error);
    process.exit(1); // Выход из процесса с ошибкой
  });

```

**Объяснение кода:**

1. **Подключение к базе данных:** 
    - В примере используется `mongoose` для подключения к базе данных MongoDB. 
    - Замените параметры подключения (`mongodb://localhost:27017/mydatabase`) на ваши.
2. **Определение модели данных:** 
    - Определяется модель `Product` с полями `name` и `price`. 
    - Замените эту модель на вашу собственную.
3. **Функция `seedProducts`:**
    - Функция `seedProducts` содержит логику для заполнения базы данных.
    - `Product.deleteMany({})` - удаляет все существующие записи из коллекции `Product`. 
    - `Product.create(...)` - создает новые записи в базе данных на основе переданного массива объектов.
4. **Запуск сидера:**
    - Вызывается функция `seedProducts()`. 
    - После успешного выполнения сидера происходит отключение от базы данных (`mongoose.connection.close()`). 
    - В случае ошибки выводится сообщение об ошибке и приложение завершает работу с кодом ошибки (`process.exit(1)`).


**Шаг 3:** Запуск сидера. Вы можете запустить сидер с помощью следующей команды:

```bash
node seed.js
```

### Важные моменты:

- Сидеры запускаются только на сервере и не доступны в браузере.
- Будьте осторожны при удалении данных в сидерах, чтобы не потерять важную информацию.
- Используйте асинхронные функции (`async/await`) для выполнения асинхронных операций, таких как работа с базой данных.

### Дополнительные возможности:

- Вы можете использовать переменные окружения в сидерах для хранения конфиденциальных данных, таких как пароли от базы данных.
- Вы можете разделить логику сидеров на несколько файлов для удобства.


### Заключение

Сидеры — это полезный инструмент для автоматизации задач, связанных с подготовкой данных в приложениях Next.js. 
Они помогают создавать более удобные и функциональные приложения. 
Используйте сидеры, чтобы упростить процесс разработки и сделать ваши приложения более качественными. 
