## Основы тестирования в Laravel

Тестирование – неотъемлемая часть разработки качественного программного обеспечения. Фреймворк Laravel предоставляет мощные инструменты для проведения тестирования на всех этапах разработки приложения. В этой статье мы рассмотрим основы тестирования в Laravel и научимся писать простые тесты для вашего приложения.

### Типы тестов

Laravel поддерживает два основных типа тестов:

* **Feature тесты (функциональные тесты)**:  тестируют приложение с точки зрения пользователя. Они взаимодействуют с приложением через HTTP-запросы и проверяют корректность работы функционала в целом.
* **Unit тесты (модульные тесты)**:  тестируют отдельные компоненты приложения, такие как классы, методы или функции, в изоляции от других частей системы.

Выбор типа теста зависит от того, что именно вы хотите протестировать. Для проверки бизнес-логики и взаимодействия компонентов лучше подходят функциональные тесты. Для проверки работы отдельных компонентов в изоляции от других частей системы – модульные.

### Запуск тестов

Все тесты Laravel хранятся в директории `tests`. Фреймворк предоставляет команду artisan для запуска тестов:

```bash
php artisan test
```

Эта команда запустит все тесты приложения. Для запуска тестов из определенной директории или конкретного файла можно использовать опции `--path` и `--filter` соответственно:

```bash
# Запуск тестов из директории Feature
php artisan test --path=tests/Feature

# Запуск теста с именем UserTest
php artisan test --filter=UserTest
```

### Написание функционального теста

Создайте файл `UserTest.php` в директории `tests/Feature` и добавьте следующий код:

```php
<?php

namespace Tests\Feature;

use Tests\TestCase;
use Illuminate\Foundation\Testing\RefreshDatabase;

class UserTest extends TestCase
{
    use RefreshDatabase;

    /**
     * Проверка успешного создания пользователя.
     */
    public function test_user_can_be_created(): void
    {
        // Отправляем POST-запрос на роут регистрации
        $response = $this->post('/register', [
            'name' => 'John Doe',
            'email' => 'johndoe@example.com',
            'password' => 'password',
            'password_confirmation' => 'password',
        ]);

        // Проверяем, что пользователь успешно перенаправлен
        $response->assertRedirect('/home');

        // Проверяем, что пользователь создан в базе данных
        $this->assertDatabaseHas('users', [
            'email' => 'johndoe@example.com',
        ]);
    }
}
```

В этом тесте мы проверяем функциональность регистрации пользователя. 

* Используем трейт `RefreshDatabase` для очистки базы данных перед каждым тестом и после него.
* Отправляем POST-запрос на роут `/register` с данными пользователя.
* Используем `assertRedirect` для проверки перенаправления на страницу `/home` после успешной регистрации.
* Используем `assertDatabaseHas` для проверки наличия записи о пользователе в базе данных.

### Написание модульного теста

Создайте файл `CalculatorTest.php` в директории `tests/Unit` и добавьте следующий код:

```php
<?php

namespace Tests\Unit;

use PHPUnit\Framework\TestCase;
use App\Services\Calculator;

class CalculatorTest extends TestCase
{
    /**
     * Проверка метода сложения.
     */
    public function test_it_can_add_two_numbers(): void
    {
        $calculator = new Calculator();

        $result = $calculator->add(5, 3);

        $this->assertEquals(8, $result);
    }
}
```

В этом тесте мы проверяем работу метода `add` класса `Calculator`. 

* Создаем экземпляр класса `Calculator`.
* Вызываем метод `add` с тестовыми данными.
* Используем `assertEquals` для сравнения полученного результата с ожидаемым значением.

### Заключение

В этой статье мы рассмотрели основы тестирования в Laravel. Вы узнали о типах тестов, научились запускать тесты с помощью artisan-команды и писать простые функциональные и модульные тесты. Помните, что написание тестов – это важная часть разработки, которая поможет вам создавать качественное и надежное программное обеспечение. 
