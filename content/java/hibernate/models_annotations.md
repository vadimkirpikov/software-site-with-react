## Модели и аннотации в Hibernate 6

В этой статье мы рассмотрим основы создания моделей данных и использования аннотаций для отображения объектов Java на реляционные базы данных с помощью Hibernate 6. 

### Сущности и аннотация `@Entity`

Hibernate работает с сущностями - объектами Java, представляющими таблицы в базе данных. Каждая сущность должна быть помечена аннотацией `@Entity`. 

```java
import jakarta.persistence.Entity;
import jakarta.persistence.Id;

@Entity
public class Product {

    @Id
    private Long id;

    private String name;

    // Геттеры и сеттеры
}
```

В этом примере `Product` - это сущность, представляющая таблицу "Product" в базе данных. 

### Атрибуты и аннотация `@Id`

Атрибуты сущности представляют колонки в таблице базы данных. Аннотация `@Id` используется для обозначения первичного ключа. 

### Стратегии генерации идентификаторов

Hibernate предлагает несколько стратегий генерации значений для первичных ключей. Одна из самых распространенных - `GenerationType.IDENTITY`, при которой база данных сама генерирует уникальные значения.

```java
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;

@Entity
public class Product {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    // Другие атрибуты и методы
}
```

### Отображение отношений между сущностями

Hibernate позволяет отображать различные типы отношений между сущностями, такие как "один к одному", "один ко многим" и "многие ко многим".

#### Отношение "один ко многим"

В этом примере показано отношение "один ко многим" между сущностями `Category` и `Product`. Одна категория может иметь много товаров.

```java
import jakarta.persistence.OneToMany;

@Entity
public class Category {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @OneToMany(mappedBy = "category")
    private List<Product> products;

    // Другие атрибуты и методы
}
```

```java
import jakarta.persistence.ManyToOne;

@Entity
public class Product {

    // ...

    @ManyToOne
    private Category category;

    // ...
}
```

Аннотация `@OneToMany` в классе `Category` указывает на отношение "один ко многим" с сущностью `Product`. Атрибут `mappedBy = "category"` указывает на поле `category` в классе `Product`, которое является обратной ссылкой на эту связь. 

Аннотация `@ManyToOne` в классе `Product` указывает на отношение "многие к одному" с сущностью `Category`.

#### Другие аннотации для настройки отношений

Hibernate предоставляет множество других аннотаций для точной настройки отношений между сущностями, такие как `@OneToOne`, `@ManyToMany`, `@JoinColumn`, `@JoinTable` и др.  

### Создание таблиц на основе сущностей

Hibernate может автоматически создавать таблицы в базе данных на основе аннотированных сущностей. Для этого необходимо настроить свойство `hibernate.hbm2ddl.auto` в файле `persistence.xml`:

```xml
<property name="hibernate.hbm2ddl.auto" value="create" />
```

Доступные значения для `hibernate.hbm2ddl.auto`:

| Значение        | Описание                                                                                                                   |
|-----------------|----------------------------------------------------------------------------------------------------------------------------|
| `create`         | Создает схему базы данных при запуске приложения и удаляет ее при остановке.                                                |
| `create-drop`   | Создает схему базы данных при запуске приложения и удаляет ее при остановке, а также при закрытии `SessionFactory`.       |
| `update`        | Обновляет схему базы данных при запуске приложения, если она отличается от описанной в сущностях.                    |
| `validate`      | Проверяет, соответствует ли схема базы данных описанию в сущностях, и генерирует исключение, если не соответствует.     |
| `none`          | Hibernate не выполняет никаких действий со схемой базы данных.                                                               |

### Заключение

В этой статье мы рассмотрели основы создания моделей данных и использования аннотаций для отображения объектов Java на реляционные базы данных с помощью Hibernate 6.  Hibernate предоставляет мощный и гибкий механизм для работы с базами данных, и мы рассмотрели только базовые возможности. 
