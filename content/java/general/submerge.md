## Получение подпотока и объединение потоков

В Java работа с несколькими потоками исполнения — неотъемлемая часть разработки многопоточных приложений. В этом разделе мы рассмотрим, как создавать подпотоки и объединять потоки для синхронизации их выполнения.

### Создание подпотоков

В Java подпоток – это поток, созданный из другого потока. Подпотоки часто используются для выполнения фоновых задач, не блокируя основной поток. Существует два основных способа создания подпотоков:

**1. Использование класса `Thread`:**

*   Создайте экземпляр класса `Thread`, передав ему объект класса, реализующего интерфейс `Runnable`.
*   Вызовите метод `start()` у созданного объекта `Thread`.

**Пример:**

```java
public class SubthreadExample implements Runnable {

    @Override
    public void run() {
        // Код, который будет выполнен в подпотоке
        System.out.println("Привет из подпотока! ID потока: " + Thread.currentThread().getId());
    }

    public static void main(String[] args) {
        // Создание объекта Runnable
        Runnable task = new SubthreadExample();

        // Создание и запуск подпотока
        Thread thread = new Thread(task);
        thread.start();

        // Код, который будет выполнен в главном потоке
        System.out.println("Привет из главного потока! ID потока: " + Thread.currentThread().getId());
    }
}
```

**2. Использование лямбда-выражений (начиная с Java 8):**

*   Создайте экземпляр класса `Thread`, передав лямбда-выражение, представляющее собой код, который будет выполнен в подпотоке.
*   Вызовите метод `start()` у созданного объекта `Thread`.

**Пример:**

```java
public class SubthreadLambdaExample {

    public static void main(String[] args) {
        // Создание и запуск подпотока с использованием лямбда-выражения
        Thread thread = new Thread(() -> {
            // Код, который будет выполнен в подпотоке
            System.out.println("Привет из подпотока! ID потока: " + Thread.currentThread().getId());
        });
        thread.start();

        // Код, который будет выполнен в главном потоке
        System.out.println("Привет из главного потока! ID потока: " + Thread.currentThread().getId());
    }
}
```

### Объединение потоков

Объединение потоков – это механизм, позволяющий одному потоку ожидать завершения работы другого потока. Это полезно, когда необходимо выполнить определенные действия только после завершения работы одного или нескольких потоков.

Для объединения потоков используется метод `join()`:

*   Вызовите метод `join()` у объекта `Thread`, представляющего поток, завершения которого необходимо дождаться.
*   Текущий поток будет заблокирован до тех пор, пока поток, для которого вызван метод `join()`, не завершится.

**Пример:**

```java
public class ThreadJoinExample {

    public static void main(String[] args) {
        // Создание и запуск подпотока
        Thread thread = new Thread(() -> {
            try {
                System.out.println("Подпоток начал работу...");
                Thread.sleep(3000); // Имитация длительной операции
                System.out.println("Подпоток завершил работу.");
            } catch (InterruptedException e) {
                System.err.println("Подпоток прерван.");
            }
        });
        thread.start();

        try {
            System.out.println("Главный поток ожидает завершения подпотока...");
            thread.join(); // Ожидание завершения подпотока
            System.out.println("Подпоток завершился. Главный поток продолжает работу.");
        } catch (InterruptedException e) {
            System.err.println("Главный поток прерван.");
        }
    }
}
```

В этом примере главный поток создает подпоток, который имитирует длительную операцию (3 секунды). 

*   Метод `thread.join()` в главном потоке блокирует его до тех пор, пока подпоток не завершит свою работу. 
*   После завершения подпотока управление возвращается главному потоку, и он продолжает свое выполнение.

### Заключение

Создание подпотоков и объединение потоков – важные концепции многопоточного программирования в Java. 

*   Подпотоки позволяют выполнять задачи в фоновом режиме, 
*   а объединение потоков обеспечивает синхронизацию их выполнения. 

Используя эти инструменты, вы можете создавать эффективные и отзывчивые многопоточные приложения. 
