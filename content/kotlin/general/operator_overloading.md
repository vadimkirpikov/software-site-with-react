## Перегрузка операторов

Kotlin, в отличие от некоторых других языков программирования, позволяет разработчикам переопределять поведение стандартных операторов, таких как `+`, `-`, `*`, `/`, `%`, `>`, `<`, `>=`, `<=`, `==`, `!=`, `in` и многих других.  Это называется перегрузкой операторов и делает код более лаконичным и интуитивно понятным.

### Основы

Для перегрузки оператора необходимо определить функцию с определенным именем, начинающимся с префикса `operator`. Например, для перегрузки оператора сложения (`+`), необходимо определить функцию `plus`. 

```kotlin
data class Point(val x: Int, val y: Int) {
    operator fun plus(other: Point): Point {
        return Point(x + other.x, y + other.y)
    }
}

fun main() {
    val p1 = Point(1, 2)
    val p2 = Point(3, 4)
    val p3 = p1 + p2 // Вызов перегруженного оператора '+'
    println(p3) // Вывод: Point(x=4, y=6)
}
```

В этом примере мы определили функцию `plus`, которая принимает один аргумент типа `Point` и возвращает новый объект `Point`, координаты которого равны сумме соответствующих координат двух точек. 

### Унарные операторы

Помимо бинарных операторов, таких как `+`, можно перегружать и унарные операторы, которые применяются к одному операнду. 

**Пример перегрузки унарного оператора:**

```kotlin
data class Counter(var value: Int) {
    operator fun inc(): Counter {
        value++
        return this
    }
}

fun main() {
    val counter = Counter(0)
    println(counter.value) // Вывод: 0
    counter.inc()
    println(counter.value) // Вывод: 1
}
```

В этом примере мы перегрузили унарный оператор инкремента (`++`) с помощью функции `inc`. 

### Перегрузка операторов сравнения

Операторы сравнения, такие как `==`, `!=`, `<`, `>`, `<=`, `>=`,  также можно перегружать.  Важно помнить, что при перегрузке операторов `==`  и `!=` необходимо также переопределить функцию `hashCode`, чтобы объекты с одинаковым содержимым имели одинаковый хэш-код. 

**Пример перегрузки операторов сравнения:**

```kotlin
data class Version(val major: Int, val minor: Int) : Comparable<Version> {
    override fun compareTo(other: Version): Int {
        return when {
            major != other.major -> major - other.major
            else -> minor - other.minor
        }
    }
}

fun main() {
    val v1 = Version(1, 2)
    val v2 = Version(1, 3)
    println(v1 < v2)  // Вывод: true
    println(v1 > v2)  // Вывод: false
    println(v1 == v2) // Вывод: false
}
```

### Перегрузка операторов присваивания

Операторы присваивания, такие как `+=`, `-=`, `*=`, `/=` и `%=`,  можно перегрузить, определив функции `plusAssign`, `minusAssign`, `timesAssign`, `divAssign` и `remAssign` соответственно.

**Пример перегрузки оператора `+=`:**

```kotlin
data class MutablePoint(var x: Int, var y: Int) {
    operator fun plusAssign(other: MutablePoint) {
        x += other.x
        y += other.y
    }
}

fun main() {
    val p1 = MutablePoint(1, 2)
    val p2 = MutablePoint(3, 4)
    p1 += p2 // Вызов перегруженного оператора '+='
    println(p1) // Вывод: MutablePoint(x=4, y=6)
}
```

### Перегрузка операторов индексирования

В Kotlin можно перегрузить операторы индексирования `get` и `set`, чтобы определить, как получать доступ к элементам объекта по индексу.

**Пример перегрузки операторов индексирования:**

```kotlin
class MyList<T>(private val list: MutableList<T>) {
    operator fun get(index: Int): T {
        return list[index]
    }

    operator fun set(index: Int, value: T) {
        list[index] = value
    }
}

fun main() {
    val myList = MyList(mutableListOf(1, 2, 3))
    println(myList[1]) // Вывод: 2
    myList[1] = 4
    println(myList[1]) // Вывод: 4
}
```

### Правила перегрузки операторов

*  Нельзя создавать новые операторы, можно только перегружать существующие.
*  Нельзя изменить приоритет операторов.
*  Нельзя изменить ассоциативность операторов.
*  Функция перегрузки оператора должна быть членом класса (или расширением) того типа, к которому применяется оператор.

Перегрузка операторов - мощный инструмент, который позволяет сделать код более читабельным и лаконичным. Однако, важно использовать ее с осторожностью и не злоупотреблять ею. Перегруженные операторы должны вести себя предсказуемо и не создавать путаницы у других разработчиков.
