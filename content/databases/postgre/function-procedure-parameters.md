## Параметры функций и процедур в PostgreSQL

Функции и процедуры в PostgreSQL могут принимать входные параметры и возвращать выходные значения. Параметры позволяют сделать ваш код более гибким и многоразовым, позволяя передавать различную информацию при каждом вызове.

### Типы параметров

PostgreSQL поддерживает несколько типов параметров:

1. **IN** (по умолчанию): Параметр передается в функцию только для чтения. Изменения значения параметра внутри функции не влияют на значение исходной переменной.

2. **OUT**: Параметр используется для возврата значения из функции. Внутри функции такой параметр ведет себя как неинициализированная переменная.

3. **INOUT**: Параметр сочетает в себе возможности IN и OUT. Значение передается в функцию и может быть изменено внутри неё, при этом изменения влияют на исходную переменную.

4. **VARIADIC**:  Позволяет передавать переменное количество аргументов одного типа. Внутри функции такой параметр ведет себя как массив.

### Объявление параметров

Параметры объявляются в скобках после имени функции или процедуры при её создании.  Каждый параметр имеет имя, тип данных и, опционально, тип передачи. Если тип передачи не указан, по умолчанию используется `IN`.

```sql
CREATE FUNCTION calculate_sum(a INTEGER, b INTEGER)
RETURNS INTEGER
LANGUAGE plpgsql
AS $$
BEGIN
  RETURN a + b;
END;
$$;
```

В данном примере функция `calculate_sum` принимает два параметра типа `INTEGER`: `a` и `b`.  Оба параметра имеют тип передачи `IN` по умолчанию. Функция возвращает результат типа `INTEGER`.

### Использование параметров внутри функции

Внутри функции параметры используются как обычные переменные. 

**Пример**:

```sql
CREATE FUNCTION get_full_name(first_name TEXT, last_name TEXT)
RETURNS TEXT
LANGUAGE plpgsql
AS $$
BEGIN
  RETURN first_name || ' ' || last_name;
END;
$$;
```

Функция `get_full_name` конкатенирует значения параметров `first_name` и `last_name` с пробелом между ними и возвращает полученную строку.

### Параметры OUT

Параметры `OUT` используются для возврата нескольких значений из функции.

**Пример**:

```sql
CREATE FUNCTION calculate_sum_and_difference(
    a INTEGER,
    b INTEGER,
    OUT sum INTEGER,
    OUT difference INTEGER
)
LANGUAGE plpgsql
AS $$
BEGIN
  sum := a + b;
  difference := a - b;
END;
$$;
```

Функция `calculate_sum_and_difference` принимает два параметра `IN` (`a` и `b`) и два параметра `OUT` (`sum` и `difference`). Внутри функции вычисляются сумма и разность переданных чисел, и результаты записываются в соответствующие параметры `OUT`.

### Параметры INOUT

Параметры `INOUT` удобны, когда требуется изменить значение переменной, переданной в функцию.

**Пример**:

```sql
CREATE FUNCTION swap_values(INOUT a INTEGER, INOUT b INTEGER)
LANGUAGE plpgsql
AS $$
DECLARE
  temp INTEGER;
BEGIN
  temp := a;
  a := b;
  b := temp;
END;
$$;
```

Функция `swap_values` принимает два параметра `INOUT`: `a` и `b`. Внутри функции значения переменных меняются местами с использованием временной переменной `temp`. 

### Параметры VARIADIC

Параметры `VARIADIC` позволяют передавать в функцию переменное количество аргументов.

**Пример**:

```sql
CREATE FUNCTION concatenate_strings(VARIADIC strings TEXT[])
RETURNS TEXT
LANGUAGE plpgsql
AS $$
DECLARE
  result TEXT := '';
  i INTEGER;
BEGIN
  FOR i IN 1..array_length(strings, 1) LOOP
    result := result || strings[i];
  END LOOP;
  RETURN result;
END;
$$;
```

Функция `concatenate_strings` принимает  параметр `VARIADIC` типа `TEXT[]`, который представляет собой массив строк. Внутри функции все элементы массива конкатенируются в одну строку, которая затем возвращается как результат.


### Значения по умолчанию

Параметры функций и процедур могут иметь значения по умолчанию. Если при вызове функции параметр не указан, используется значение по умолчанию.

**Пример**:

```sql
CREATE FUNCTION greet(name TEXT, greeting TEXT DEFAULT 'Привет')
RETURNS TEXT
LANGUAGE plpgsql
AS $$
BEGIN
  RETURN greeting || ', ' || name || '!';
END;
$$;
```

Функция `greet` принимает два параметра: `name` и `greeting`.  Параметр `greeting` имеет значение по умолчанию `'Привет'`.

При вызове функции `greet('Анна')` результатом будет строка "Привет, Анна!".

При вызове функции `greet('Иван', 'Здравствуйте')` результатом будет строка "Здравствуйте, Иван!".

### Вывод

Параметры функций и процедур в PostgreSQL - это мощный инструмент, который позволяет создавать гибкий и многоразовый код. 

Используйте параметры `IN`, `OUT`, `INOUT` и `VARIADIC`, чтобы максимально эффективно передавать данные в функции и из функций. 
