## Сортировка данных (ORDER BY) в PostgreSQL

В реляционных базах данных порядок строк в таблице по умолчанию не определен.  Для вывода данных в нужном порядке используется оператор `ORDER BY`.  Он позволяет сортировать результирующий набор по одному или нескольким столбцам в порядке возрастания или убывания.

### Базовый синтаксис

```sql
SELECT column1, column2, ...
FROM table_name
ORDER BY column1 [ASC | DESC], column2 [ASC | DESC], ...;
```

* **column1, column2, ...** - столбцы, по которым будет производиться сортировка.
* **table_name** - имя таблицы.
* **ASC** - сортировка по возрастанию (по умолчанию).
* **DESC** - сортировка по убыванию.

**Пример:** 

Выведем список сотрудников, отсортированных по фамилии в алфавитном порядке:

```sql
-- Создадим таблицу сотрудников
CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    salary NUMERIC(10,2)
);

-- Добавим данные в таблицу
INSERT INTO employees (first_name, last_name, salary) VALUES
    ('Иван', 'Иванов', 50000),
    ('Петр', 'Петров', 60000),
    ('Сидор', 'Сидоров', 55000);

-- Выведем список сотрудников, отсортированный по фамилии
SELECT first_name, last_name
FROM employees
ORDER BY last_name ASC;
```

Результат:

```
 first_name | last_name 
------------+-----------
 Иван       | Иванов
 Петр       | Петров
 Сидор      | Сидоров
```

### Сортировка по нескольким столбцам

Для сортировки по нескольким столбцам укажите их через запятую в операторе `ORDER BY`. Сначала будет выполнена сортировка по первому указанному столбцу, затем, для строк с одинаковыми значениями в первом столбце, будет выполнена сортировка по второму столбцу и так далее.

**Пример:**

Отсортируем сотрудников сначала по отделу, а затем по фамилии в каждом отделе:

```sql
-- Добавим столбец department в таблицу employees
ALTER TABLE employees ADD COLUMN department VARCHAR(50);

-- Обновим данные в таблице
UPDATE employees SET department = 'IT' WHERE id IN (1, 2);
UPDATE employees SET department = 'Sales' WHERE id = 3;

-- Выведем список сотрудников, отсортированный по отделу и фамилии
SELECT first_name, last_name, department
FROM employees
ORDER BY department ASC, last_name ASC;
```

Результат:

```
 first_name | last_name | department 
------------+-----------+------------
 Иван       | Иванов    | IT
 Петр       | Петров    | IT
 Сидор      | Сидоров   | Sales
```

### Сортировка по числовым данным и датам

Сортировка по числовым данным и датам работает аналогично сортировке по текстовым данным.  
  
**Пример:**

Отсортируем сотрудников по размеру зарплаты в порядке убывания:

```sql
SELECT first_name, last_name, salary
FROM employees
ORDER BY salary DESC;
```

Результат:

```
 first_name | last_name |  salary  
------------+-----------+----------
 Петр       | Петров    | 60000.00
 Сидор      | Сидоров   | 55000.00
 Иван       | Иванов    | 50000.00
```

### Сортировка по вычисляемым значениям

Вы можете сортировать данные по столбцам, которые не являются частью таблицы, а являются результатом вычислений. 

**Пример:**

Выведем список сотрудников с их годовой зарплатой, отсортированный по годовой зарплате:

```sql
SELECT first_name, last_name, salary * 12 AS annual_salary
FROM employees
ORDER BY annual_salary DESC;
```

Результат:

```
 first_name | last_name | annual_salary 
------------+-----------+---------------
 Петр       | Петров    |       720000.00
 Сидор      | Сидоров   |       660000.00
 Иван       | Иванов    |       600000.00
```

### Дополнительные возможности

PostgreSQL предоставляет множество дополнительных возможностей для сортировки данных, которые будут рассмотрены в следующих разделах:

* Использование индексов для ускорения сортировки.
* Сортировка с учетом регистра.
* Сортировка с использованием collation.
* NULL значения при сортировке.
* Ограничение количества строк с помощью LIMIT и OFFSET.

Данная статья рассмотрела основные принципы использования оператора `ORDER BY` в PostgreSQL. Для получения более подробной информации обратитесь к официальной документации PostgreSQL. 
