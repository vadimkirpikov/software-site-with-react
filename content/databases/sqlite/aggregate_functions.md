## Функции агрегации в SQLite

Функции агрегации в SQLite позволяют получать сводную информацию о наборах данных. С их помощью вы можете легко посчитать количество записей, найти среднее значение, определить минимальное или максимальное значение, а также суммировать значения в столбце.

### Функция SUM()

Функция `SUM()` используется для суммирования значений в столбце. Она принимает один аргумент - имя столбца, по которому нужно просуммировать значения.

**Синтаксис:**

```sql
SUM(столбец)
```

**Пример:**

Допустим, у нас есть таблица `products` со следующими данными:

| product_id | product_name | price |
|---|---|---|
| 1 | Apple | 1.00 |
| 2 | Banana | 0.50 |
| 3 | Orange | 0.75 |
| 4 | Grape | 2.00 |

Чтобы получить общую стоимость всех продуктов, мы можем использовать следующий запрос:

```sql
SELECT SUM(price) AS total_price FROM products;
```

Результат:

| total_price |
|---|---|
| 4.25 |

### Функция AVG()

Функция `AVG()` используется для нахождения среднего значения числовых данных в столбце. Она также принимает один аргумент - имя столбца.

**Синтаксис:**

```sql
AVG(столбец)
```

**Пример:**

Используя ту же таблицу `products`, найдем среднюю цену продукта:

```sql
SELECT AVG(price) AS average_price FROM products;
```

Результат:

| average_price |
|---|---|
| 1.0625 |

### Функция COUNT()

Функция `COUNT()` используется для подсчета количества строк, удовлетворяющих определенному условию. Она может принимать следующие аргументы:

- `*` - подсчитывает количество строк во всей таблице.
- `столбец` - подсчитывает количество значений в указанном столбце, исключая `NULL` значения.
- `DISTINCT столбец` - подсчитывает количество уникальных значений в указанном столбце, исключая `NULL` значения.

**Синтаксис:**

```sql
COUNT(*)
COUNT(столбец)
COUNT(DISTINCT столбец)
```

**Примеры:**

1. Посчитаем общее количество продуктов в таблице `products`:

```sql
SELECT COUNT(*) AS total_products FROM products;
```

Результат:

| total_products |
|---|---|
| 4 |

2. Посчитаем количество различных цен на продукты:

```sql
SELECT COUNT(DISTINCT price) AS distinct_prices FROM products;
```

Результат:

| distinct_prices |
|---|---|
| 4 |

### Функция MIN()

Функция `MIN()` возвращает минимальное значение в столбце.

**Синтаксис:**

```sql
MIN(столбец)
```

**Пример:**

Найдем минимальную цену продукта в таблице `products`:

```sql
SELECT MIN(price) AS min_price FROM products;
```

Результат:

| min_price |
|---|---|
| 0.50 |

### Функция MAX()

Функция `MAX()` возвращает максимальное значение в столбце.

**Синтаксис:**

```sql
MAX(столбец)
```

**Пример:**

Найдем максимальную цену продукта в таблице `products`:

```sql
SELECT MAX(price) AS max_price FROM products;
```

Результат:

| max_price |
|---|---|
| 2.00 |

### Использование функций агрегации с предложением GROUP BY

Функции агрегации становятся особенно полезными при использовании с предложением `GROUP BY`. `GROUP BY` позволяет группировать строки с одинаковыми значениями в указанном столбце, а затем применять функцию агрегации к каждой группе.

**Пример:**

Допустим, у нас есть таблица `orders` со следующими данными:

| order_id | customer_id | product_id | quantity |
|---|---|---|---|
| 1 | 1 | 1 | 2 |
| 2 | 2 | 3 | 1 |
| 3 | 1 | 2 | 3 |
| 4 | 3 | 4 | 2 |
| 5 | 2 | 1 | 1 |

Чтобы узнать общее количество заказанных продуктов каждым пользователем, мы можем использовать следующий запрос:

```sql
SELECT customer_id, SUM(quantity) AS total_quantity 
FROM orders
GROUP BY customer_id;
```

Результат:

| customer_id | total_quantity |
|---|---|
| 1 | 5 |
| 2 | 2 |
| 3 | 2 |

В этом запросе мы группируем заказы по `customer_id`, а затем используем `SUM(quantity)`, чтобы найти общее количество продуктов, заказанных каждым пользователем.

Это лишь базовый обзор функций агрегации в SQLite. Более подробную информацию о каждой функции и их использовании с другими предложениями SQL можно найти в официальной документации SQLite.
