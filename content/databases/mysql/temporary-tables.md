## Временные таблицы в MySQL

Временные таблицы - это особый тип таблиц в MySQL, которые существуют только в течение текущего сеанса подключения к базе данных. Они используются для хранения временных наборов данных, которые не нужно сохранять после завершения работы с ними. 

### Создание временных таблиц

Временные таблицы создаются с помощью ключевого слова `TEMPORARY` при использовании оператора `CREATE TABLE`. 

```sql
CREATE TEMPORARY TABLE НазваниеВременнойТаблицы (
   Столбец1 ТипДанных,
   Столбец2 ТипДанных,
   ...
);
```

**Пример:**

```sql
CREATE TEMPORARY TABLE tmp_users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  age INT
);
```
Этот код создаст временную таблицу `tmp_users` с тремя столбцами: `id`, `name` и `age`.

### Заполнение временных таблиц данными

Заполнить временные таблицы данными можно так же, как и обычные таблицы, с помощью оператора `INSERT`.

**Пример:**

```sql
INSERT INTO tmp_users (name, age) VALUES 
('Иван', 30),
('Мария', 25),
('Петр', 40);
```

Этот код добавит три записи в созданную ранее временную таблицу `tmp_users`.

### Чтение данных из временных таблиц

Чтение данных из временных таблиц также осуществляется с помощью оператора `SELECT`, как и в случае с обычными таблицами.

**Пример:**

```sql
SELECT * FROM tmp_users;
```

Этот код вернет все записи из временной таблицы `tmp_users`.

### Особенности временных таблиц:

* **Видимость:** Временные таблицы видны только в рамках текущего сеанса подключения. Если закрыть соединение с базой данных, то временная таблица будет автоматически удалена.
* **Совпадение имен:**  Можно создать временную таблицу с таким же именем, что и у обычной таблицы. В этом случае, в рамках текущего сеанса, при обращении по имени, будет использоваться временная таблица.
* **Производительность:** Временные таблицы часто используются для повышения производительности запросов, так как они хранятся в памяти и не требуют записи на диск.

### Примеры использования временных таблиц

**1. Хранение промежуточных результатов запросов:**

Временные таблицы могут использоваться для хранения промежуточных результатов сложных запросов, что позволяет разбить сложный запрос на несколько более простых и повысить читаемость кода.

**Пример:**

```sql
-- Выбираем всех пользователей старше 30 лет и сохраняем во временную таблицу
CREATE TEMPORARY TABLE tmp_older_users AS
SELECT * FROM users WHERE age > 30;

-- Выбираем имена пользователей из временной таблицы
SELECT name FROM tmp_older_users;
```

**2. Массовое обновление данных:**

Временные таблицы могут использоваться для массового обновления данных в основной таблице.

**Пример:**

```sql
-- Создаем временную таблицу с новыми значениями для обновления
CREATE TEMPORARY TABLE tmp_updates (
  id INT PRIMARY KEY,
  new_age INT
);

-- Заполняем временную таблицу данными для обновления
INSERT INTO tmp_updates (id, new_age) VALUES 
(1, 31),
(2, 26);

-- Обновляем основную таблицу `users`
UPDATE users u
JOIN tmp_updates tu ON u.id = tu.id
SET u.age = tu.new_age;
```

### Ограничения временных таблиц:

* Нельзя создавать индексы на временных таблицах, используя `FULLTEXT` или `SPATIAL` типы индексов.
* Нельзя использовать опцию `PARTITION BY` при создании временных таблиц.

### Удаление временных таблиц

Временные таблицы удаляются автоматически при завершении сессии подключения. Также их можно удалить вручную с помощью оператора `DROP TEMPORARY TABLE`.

**Пример:**

```sql
DROP TEMPORARY TABLE tmp_users;
```

### Заключение

Временные таблицы являются мощным инструментом MySQL, который позволяет эффективно работать с временными данными и оптимизировать производительность запросов. Важно помнить об их особенностях и ограничениях при использовании в приложениях. 
