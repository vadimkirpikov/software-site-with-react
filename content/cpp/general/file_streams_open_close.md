## Файловые потоки. Открытие и закрытие.

Работа с файлами — неотъемлемая часть большинства программ.  В C++ взаимодействие с файлами осуществляется с помощью файловых потоков. Файловый поток — это объект, представляющий собой последовательность байтов, которая может быть связана с файлом на диске или с другим устройством ввода-вывода.

### Подключение заголовочного файла

Для работы с файловыми потоками необходимо подключить заголовочный файл `<fstream>`:

```cpp
#include <fstream>
```

### Типы файловых потоков

Стандартная библиотека C++ предоставляет три основных типа файловых потоков:

| Тип потока  | Описание                                                                |
|-------------|-------------------------------------------------------------------------|
| `ifstream`  | Поток для чтения данных из файла (**i**nput **f**ile **stream**)          |
| `ofstream`  | Поток для записи данных в файл (**o**utput **f**ile **stream**)         |
| `fstream`   | Поток для чтения и записи данных в файл (**f**ile **stream**)          |

### Открытие файла

Прежде чем начать работу с файлом, его необходимо открыть. Для этого у объектов файловых потоков предусмотрены конструкторы и метод `open()`. 

#### Открытие файла с помощью конструктора

```cpp
std::ofstream outputFile("example.txt"); // Создание потока для записи и открытие файла "example.txt"
```

В данном примере создается объект `outputFile` типа `ofstream` и одновременно с этим открывается файл с именем "example.txt" для записи.

#### Открытие файла с помощью метода `open()`

```cpp
std::ifstream inputFile; // Создание потока для чтения
inputFile.open("input.txt"); // Открытие файла "input.txt" для чтения
```

Здесь сначала создается объект `inputFile` типа `ifstream`, а затем вызывается метод `open()` для открытия файла "input.txt" в режиме чтения.

### Режимы открытия файла

При открытии файла можно указать режим открытия. Режим открытия определяет, какие операции можно выполнять с файлом (чтение, запись, добавление) и как будет обрабатываться файл (создание нового, перезапись существующего).

Режимы открытия файла представлены в таблице:

| Режим            | Описание                                                                                    |
|-----------------|--------------------------------------------------------------------------------------------|
| `ios::in`        | Открытие файла для чтения                                                                    |
| `ios::out`       | Открытие файла для записи. Если файл существует, его содержимое будет удалено.               |
| `ios::app`       | Открытие файла для добавления данных в конец файла.                                            |
| `ios::ate`       | Открытие файла и установка указателя на конец файла.                                        |
| `ios::trunc`     | Удаление содержимого файла, если он существует.                                               |
| `ios::binary`   | Открытие файла в бинарном режиме.                                                            |

Режимы открытия можно комбинировать с помощью оператора побитового ИЛИ (`|`). Например, чтобы открыть файл для чтения и записи, необходимо использовать следующий код:

```cpp
std::fstream file("data.txt", std::ios::in | std::ios::out);
```

### Проверка успешности открытия файла

После открытия файла важно проверить, успешно ли он был открыт. Для этого можно воспользоваться оператором `!`:

```cpp
std::ifstream inputFile("input.txt");

if (!inputFile) {
  std::cerr << "Ошибка открытия файла!" << std::endl;
  return 1;
}
```

### Закрытие файла

После завершения работы с файлом его необходимо закрыть. Закрытие файла освобождает ресурсы, связанные с ним. Для закрытия файла используется метод `close()`:

```cpp
inputFile.close();
```

В большинстве случаев, файл закрывается автоматически при уничтожении объекта файлового потока (например, при выходе из функции, в которой он был создан).

### Пример использования файловых потоков

```cpp
#include <iostream>
#include <fstream>

int main() {
  // Открытие файла "example.txt" для записи
  std::ofstream outputFile("example.txt");

  // Проверка успешности открытия файла
  if (!outputFile) {
    std::cerr << "Ошибка открытия файла!" << std::endl;
    return 1;
  }

  // Запись данных в файл
  outputFile << "Привет, мир!" << std::endl;
  outputFile << "Это пример работы с файлами в C++." << std::endl;

  // Закрытие файла
  outputFile.close();

  // Открытие файла "example.txt" для чтения
  std::ifstream inputFile("example.txt");

  // Проверка успешности открытия файла
  if (!inputFile) {
    std::cerr << "Ошибка открытия файла!" << std::endl;
    return 1;
  }

  // Чтение данных из файла и вывод на консоль
  std::string line;
  while (std::getline(inputFile, line)) {
    std::cout << line << std::endl;
  }

  // Закрытие файла
  inputFile.close();

  return 0;
}
```

Этот пример демонстрирует базовые операции с файлами:
1. Открытие файла "example.txt" для записи.
2. Запись двух строк текста в файл.
3. Закрытие файла.
4. Открытие файла "example.txt" для чтения.
5. Чтение строк из файла и вывод их на консоль.
6. Закрытие файла.


**Важно:** 

* Всегда проверяйте успешность открытия файла.
* Закрывайте файлы после завершения работы с ними. 

В следующих разделах руководства мы рассмотрим более подробно операции чтения и записи данных, а также обработку ошибок при работе с файлами.
