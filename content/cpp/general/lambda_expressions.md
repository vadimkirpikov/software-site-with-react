## Лямбда-выражения в C++

Лямбда-выражения, появившиеся в C++11, предоставляют удобный способ определения анонимных функций непосредственно в месте их использования. Они позволяют писать более компактный и выразительный код, особенно при работе с алгоритмами стандартной библиотеки и обработке событий.

### Базовый синтаксис

Лямбда-выражение в C++ имеет следующий общий вид:

```c++
[захват](параметры) -> тип_возвращаемого_значения { тело_функции }
```

* **Захват (`[]`)**: определяет, какие переменные из внешней области видимости доступны внутри лямбда-функции.
* **Список параметров (`()`)**: список параметров, передаваемых в лямбда-функцию, аналогично обычной функции.
* **Тип возвращаемого значения (`-> тип_возвращаемого_значения`)**: необязательный спецификатор типа возвращаемого значения. Если не указан, компилятор пытается вывести его автоматически.
* **Тело функции (`{}`)**: код, выполняемый при вызове лямбда-функции.

### Пример простого лямбда-выражения

```c++
#include <iostream>

int main() {
    // Лямбда-функция, которая выводит "Hello, world!" в консоль
    auto greet = []() { 
        std::cout << "Hello, world!" << std::endl;
    };

    // Вызов лямбда-функции
    greet(); 

    return 0;
}
```

В этом примере мы определили лямбда-функцию `greet`, которая не принимает параметров и не возвращает значение. Захват пуст (`[]`), что означает, что функция не использует переменные из внешней области видимости.

### Захват переменных

Лямбда-выражения могут захватывать переменные из внешней области видимости. Это делается с помощью списка захвата `[]`.

* **Захват по значению (`[var]`)**: создает копию переменной `var` внутри лямбда-функции.
* **Захват по ссылке (`[&var]`)**: позволяет лямбда-функции изменять исходную переменную `var`.
* **Захват всех переменных по значению (`[=]`)**.
* **Захват всех переменных по ссылке (`[&]`).

**Пример:**

```c++
#include <iostream>

int main() {
    int x = 10;

    // Захват x по значению
    auto add_to_copy = [x](int y) {
        return x + y; // x - копия переменной из внешней области
    };

    // Захват x по ссылке
    auto add_to_original = [&x](int y) {
        x += y; // Изменяем исходный x
        return x; 
    };

    std::cout << "add_to_copy(5): " << add_to_copy(5) << std::endl; // Вывод: 15
    std::cout << "x: " << x << std::endl; // Вывод: 10

    std::cout << "add_to_original(5): " << add_to_original(5) << std::endl; // Вывод: 15
    std::cout << "x: " << x << std::endl; // Вывод: 15

    return 0;
}
```

### Использование лямбда-выражений с алгоритмами STL

Лямбда-выражения идеально подходят для использования с алгоритмами стандартной библиотеки C++, такими как `std::for_each`, `std::transform`, `std::sort` и т.д.

**Пример:**

```c++
#include <iostream>
#include <vector>
#include <algorithm>

int main() {
    std::vector<int> numbers = {1, 5, 2, 8, 3};

    // Увеличиваем каждый элемент вектора на 10
    std::for_each(numbers.begin(), numbers.end(), [](int& n){ n += 10; });

    // Выводим измененный вектор
    for (auto n : numbers) {
        std::cout << n << " ";
    }
    std::cout << std::endl; // Вывод: 11 15 12 18 13

    return 0;
}
```

### Вывод типа лямбда-выражения

C++11 ввел ключевое слово `auto` для автоматического вывода типа. С его помощью можно объявлять переменные, инициализируемые лямбда-выражениями.

```c++
auto sum = [](int a, int b) { return a + b; };

// Теперь можно использовать 'sum' как обычную функцию
int result = sum(5, 3);
```

### Лямбда-выражения и обобщенное программирование

Лямбда-выражения в C++ тесно интегрированы с шаблонами и обобщенным программированием.

**Пример:**

```c++
#include <iostream>

// Шаблонная функция, принимающая лямбда-выражение в качестве аргумента
template<typename Func>
void apply(Func func, int a, int b) {
    std::cout << func(a, b) << std::endl;
}

int main() {
    // Вызов apply с лямбда-выражением для сложения
    apply([](int a, int b) { return a + b; }, 5, 3); 

    // Вызов apply с лямбда-выражением для умножения
    apply([](int a, int b) { return a * b; }, 5, 3); 

    return 0;
}
```

Лямбда-выражения - мощный инструмент, который делает код C++ более лаконичным, выразительным и гибким. Их использование особенно ценно при работе с алгоритмами, обработке событий и обобщенном программировании.
