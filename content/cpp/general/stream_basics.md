## Базовые типы для работы с потоками в C++20

C++ предоставляет мощные и гибкие инструменты для работы с потоками ввода/вывода. Эти инструменты позволяют взаимодействовать с файлами, консолью, сетью и другими устройствами ввода/вывода.  В основе этой системы лежат базовые типы, предоставляемые стандартной библиотекой.

### Обзор основных типов

Для начала работы с потоками в C++ необходимо познакомиться с ключевыми типажами и классами, которые составляют основу этой системы:

| Тип/Класс     | Описание                                                                             |
|--------------|--------------------------------------------------------------------------------------|
| `std::ios_base`  | Базовый класс для всех классов потоков, определяющий основные характеристики потока.   |
| `std::basic_ios<CharT, Traits>` | Шаблонный класс, расширяющий `std::ios_base` для конкретного типа символов.         |
| `std::basic_istream<CharT, Traits>` | Шаблонный класс для входных потоков, наследующий `std::basic_ios`.              |
| `std::basic_ostream<CharT, Traits>` | Шаблонный класс для выходных потоков, наследующий `std::basic_ios`.              |
| `std::basic_iostream<CharT, Traits>` | Шаблонный класс для двунаправленных потоков, наследующий `std::basic_istream` и `std::basic_ostream`. |

#### Специализации для работы с char и wchar_t

Для удобства стандартная библиотека предоставляет специализации основных шаблонных классов для работы с наиболее распространёнными типами символов:

* `std::cin`: Объект класса `std::istream`, связанный со стандартным вводом (обычно клавиатура).
* `std::cout`: Объект класса `std::ostream`, связанный со стандартным выводом (обычно консоль).
* `std::cerr`: Объект класса `std::ostream`, связанный со стандартным потоком ошибок (обычно консоль).
* `std::clog`: Объект класса `std::ostream`, аналогичный `std::cerr`, но  буферизированный. 
* `std::wcin`, `std::wcout`, `std::wcerr`, `std::wclog`: Аналогичные объекты для работы с широкими символами (`wchar_t`).

###  Основные операции ввода/вывода

#### Вывод данных

Для вывода данных в C++ используется оператор `<<` (оператор сдвига влево). 

```c++
#include <iostream>

int main() {
  int age = 25;
  std::string name = "John";

  // Вывод данных в консоль
  std::cout << "Имя: " << name << ", возраст: " << age << std::endl;

  return 0;
}
```

В этом примере оператор `<<` используется для последовательного вывода строки, значения переменной `name`, строки, значения переменной `age` и манипулятора `std::endl`. 

#### Ввод данных

Для ввода данных с клавиатуры используется оператор `>>` (оператор сдвига вправо).

```c++
#include <iostream>

int main() {
  int age;
  std::string name;

  std::cout << "Введите имя: ";
  std::cin >> name;

  std::cout << "Введите возраст: ";
  std::cin >> age;

  std::cout << "Имя: " << name << ", возраст: " << age << std::endl;

  return 0;
}
```

В этом примере оператор `>>` используется для чтения данных из стандартного входного потока (`std::cin`) и сохранения их в переменных `name` и `age`.

#### Работа с файлами

Для работы с файлами необходимо подключить заголовочный файл `<fstream>`. 

##### Запись в файл

```c++
#include <iostream>
#include <fstream>

int main() {
  // Открываем файл для записи
  std::ofstream outputFile("example.txt");

  if (outputFile.is_open()) {
    // Записываем данные в файл
    outputFile << "Пример записи в файл." << std::endl;
    outputFile << "Еще одна строка." << std::endl;

    // Закрываем файл
    outputFile.close();

    std::cout << "Данные успешно записаны в файл." << std::endl;
  } else {
    std::cerr << "Ошибка открытия файла!" << std::endl;
  }

  return 0;
}
```

В этом примере создаётся объект `outputFile` класса `std::ofstream`, связанный с файлом "example.txt". Далее, с помощью оператора `<<`, данные записываются в файл. 

##### Чтение из файла

```c++
#include <iostream>
#include <fstream>
#include <string>

int main() {
  // Открываем файл для чтения
  std::ifstream inputFile("example.txt");
  std::string line;

  if (inputFile.is_open()) {
    // Читаем данные из файла построчно
    while (getline(inputFile, line)) {
      std::cout << line << std::endl;
    }

    // Закрываем файл
    inputFile.close();
  } else {
    std::cerr << "Ошибка открытия файла!" << std::endl;
  }

  return 0;
}
```

В этом примере создаётся объект `inputFile` класса `std::ifstream`, связанный с файлом "example.txt". Далее, с помощью функции `getline()`, данные считываются из файла построчно.

### Манипуляторы

Манипуляторы позволяют управлять форматированием  и другими аспектами работы с потоками. 

| Манипулятор | Описание                                                        |
|-------------|-----------------------------------------------------------------|
| `std::endl` | Вставляет символ новой строки и сбрасывает буфер вывода.     |
| `std::flush` | Сбрасывает буфер вывода.                                      |
| `std::setw(n)` | Устанавливает ширину поля вывода для следующего значения.      |
| `std::setprecision(n)` | Устанавливает точность вывода чисел с плавающей точкой.       |
| `std::boolalpha` | Включает вывод булевых значений как "true" и "false".          |
| `std::noboolalpha` | Выключает вывод булевых значений как "true" и "false".         |

Пример использования манипуляторов:

```c++
#include <iostream>
#include <iomanip>

int main() {
  double pi = 3.1415926535;

  // Устанавливаем ширину поля и точность вывода
  std::cout << std::setw(10) << std::setprecision(3) << pi << std::endl;

  return 0;
}
```

Этот код выведет число `pi` с шириной поля 10 символов и точностью 3 знака после запятой.

### Заключение

В этой статье мы рассмотрели базовые типы и операции, необходимые для работы с потоками ввода/вывода в C++. Эти знания послужат фундаментом для изучения более сложных тем, таких как форматированный ввод/вывод, работа с строковыми потоками и создание пользовательских манипуляторов. 
