## Основы тестирования в C#

Тестирование является неотъемлемой частью разработки программного обеспечения. Оно позволяет убедиться в том, что код работает корректно, соответствует требованиям и не содержит ошибок. В этой статье мы рассмотрим основы тестирования в C# с использованием фреймворка xUnit.

### Зачем нужно тестировать код?

* **Обнаружение ошибок:** Тесты помогают выявить ошибки на ранних стадиях разработки, что упрощает их исправление.
* **Улучшение качества кода:**  Написание тестов заставляет задуматься о различных сценариях использования кода и его корректной работе в каждом из них.
* **Упрощение рефакторинга:**  Тесты дают уверенность в том, что изменения в коде не сломали существующую функциональность.
* **Документирование кода:** Тесты могут служить примерами использования кода и демонстрировать его ожидаемое поведение.

### Виды тестов

Существует множество видов тестов, но наиболее распространенными являются:

* **Модульные тесты (Unit-тесты):** Проверяют корректность работы отдельных модулей (классов, методов) в изоляции от других частей системы.
* **Интеграционные тесты:** Проверяют взаимодействие между разными модулями системы.

В этой статье мы сфокусируемся на модульном тестировании.

### Знакомство с xUnit

xUnit - это популярный фреймворк для написания и запуска unit-тестов в C#. Он предоставляет простой и гибкий способ определения тестов и анализа их результатов.

### Создание проекта с тестами

1. **Создайте проект xUnit:** В Visual Studio выберите "Создать новый проект" -> "xUnit Test Project (.NET Core)" (или .NET, в зависимости от вашего проекта). 
2. **Добавьте ссылку на тестируемый проект:**  В обозревателе решений, кликните правой кнопкой мыши на "Зависимости" в вашем тестовом проекте и выберите "Добавить ссылку на проект". Выберите ваш основной проект, который вы будете тестировать.

### Написание первого теста

Рассмотрим пример простого класса `Calculator`:

```C#
// Calculator.cs
public class Calculator
{
    public int Add(int a, int b)
    {
        return a + b;
    }
}
```

Создадим тест для метода `Add`:

```C#
// CalculatorTests.cs
using Xunit;

public class CalculatorTests
{
    [Fact] // Помечает метод как тест
    public void Add_ReturnsCorrectSum()
    {
        // Arrange (Подготовка)
        var calculator = new Calculator();

        // Act (Действие)
        var result = calculator.Add(2, 3);

        // Assert (Проверка)
        Assert.Equal(5, result);
    }
}
```

В этом примере:

* `[Fact]` - атрибут xUnit, который помечает метод как тест.
* Метод `Add_ReturnsCorrectSum` - это сам тест. Имя теста должно быть описательным и отражать его цель.
* Код теста разделен на три части:
    * **Arrange:** Подготовка данных и объектов, необходимых для теста.
    * **Act:** Вызов тестируемого метода.
    * **Assert:** Проверка результата выполнения метода.

### Запуск тестов

Запустить тесты можно с помощью Test Explorer в Visual Studio (меню "Тест" -> "Windows" -> "Test Explorer").  xUnit запустит все методы, помеченные атрибутом `[Fact]`, и отобразит результаты в Test Explorer.

### Атрибуты

xUnit предоставляет множество атрибутов для управления поведением тестов, например:

* `[Theory]` - используется для тестов, которые должны быть выполнены с разными входными данными.
* `[InlineData(…)]` - используется совместно с `[Theory]` для задания входных данных для теста.

Пример использования `[Theory]` и `[InlineData]`:

```C#
[Theory]
[InlineData(2, 3, 5)]
[InlineData(-1, 1, 0)]
public void Add_ReturnsCorrectSum_DataDriven(int a, int b, int expected)
{
    var calculator = new Calculator();
    var result = calculator.Add(a, b);
    Assert.Equal(expected, result);
}
```

### Утверждения (Assertions)

xUnit предоставляет множество методов для проверки утверждений:

* `Assert.Equal(expected, actual)`: Проверяет, равны ли два объекта.
* `Assert.True(condition)`: Проверяет, истинно ли условие.
* `Assert.False(condition)`: Проверяет, ложно ли условие.
* `Assert.Throws<TException>(Action action)`: Проверяет, что выполнение кода `action` выбрасывает исключение типа `TException`.

### Заключение

В этой статье мы рассмотрели базовые принципы тестирования в C# с использованием фреймворка xUnit. Регулярное написание тестов – важная практика, которая позволит повысить качество вашего кода и уверенность в его работоспособности. 
