## Продвинутые коллекции: Queue, Stack, LinkedList

Помимо базовых коллекций, таких как массивы и списки, C# предлагает ряд структур данных, оптимизированных под специфичные задачи. В этой статье мы рассмотрим три такие коллекции: Queue (очередь), Stack (стек) и LinkedList (связный список).

### Queue (Очередь)

Очередь представляет собой коллекцию, работающую по принципу "первый вошел - первый вышел" (FIFO). Это означает, что элемент, добавленный в очередь первым, будет первым же извлечен.

**Основные операции с очередью:**

* `Enqueue()`: Добавляет элемент в конец очереди.
* `Dequeue()`: Извлекает и возвращает первый элемент очереди.
* `Peek()`: Возвращает первый элемент очереди без его удаления.
* `Count`: Возвращает количество элементов в очереди.

**Пример использования очереди:**

```C#
using System.Collections.Generic;

// Создание очереди целых чисел
Queue<int> numbersQueue = new Queue<int>();

// Добавление элементов в очередь
numbersQueue.Enqueue(10);
numbersQueue.Enqueue(20);
numbersQueue.Enqueue(30);

// Вывод количества элементов в очереди
Console.WriteLine("Количество элементов в очереди: {0}", numbersQueue.Count); // Выведет: 3

// Извлечение и вывод элементов из очереди
while (numbersQueue.Count > 0)
{
    Console.WriteLine(numbersQueue.Dequeue()); // Выведет: 10, 20, 30 (на отдельных строках)
}
```

### Stack (Стек)

Стек - это коллекция, работающая по принципу "последний вошел - первый вышел" (LIFO).  Это значит, что последний добавленный элемент будет первым доступным для извлечения.

**Основные операции со стеком:**

* `Push()`: Добавляет элемент на вершину стека.
* `Pop()`: Извлекает и возвращает элемент с вершины стека.
* `Peek()`: Возвращает элемент с вершины стека без его удаления.
* `Count`: Возвращает количество элементов в стеке.

**Пример использования стека:**

```C#
using System.Collections.Generic;

// Создание стека строк
Stack<string> wordsStack = new Stack<string>();

// Добавление элементов в стек
wordsStack.Push("Мир");
wordsStack.Push("Привет,");

// Вывод количества элементов в стеке
Console.WriteLine("Количество элементов в стеке: {0}", wordsStack.Count); // Выведет: 2

// Извлечение и вывод элементов из стека
while (wordsStack.Count > 0)
{
    Console.Write(wordsStack.Pop() + " "); // Выведет: Привет, Мир
}
```

### LinkedList (Связный список)

Связный список - это динамическая структура данных, где каждый элемент (узел) содержит ссылку на следующий элемент.  Это позволяет эффективно добавлять и удалять элементы в произвольной позиции списка.

**Основные операции со связным списком:**

* `AddFirst()`: Добавляет новый элемент в начало списка.
* `AddLast()`: Добавляет новый элемент в конец списка.
* `AddBefore()`: Вставляет новый элемент перед указанным.
* `AddAfter()`: Вставляет новый элемент после указанного.
* `Remove()`: Удаляет первый найденный элемент, соответствующий заданному значению.
* `RemoveFirst()`: Удаляет первый элемент списка.
* `RemoveLast()`: Удаляет последний элемент списка.
* `Count`: Возвращает количество элементов в списке.
* `First`: Возвращает первый элемент списка.
* `Last`: Возвращает последний элемент списка.

**Пример использования связного списка:**

```C#
using System.Collections.Generic;

// Создание связного списка строк
LinkedList<string> colorsList = new LinkedList<string>();

// Добавление элементов в список
colorsList.AddLast("Красный");
colorsList.AddLast("Зеленый");
colorsList.AddFirst("Синий");

// Вставка элемента после "Зеленый"
LinkedListNode<string> greenNode = colorsList.Find("Зеленый");
colorsList.AddAfter(greenNode, "Желтый");

// Вывод элементов списка
foreach (string color in colorsList)
{
    Console.WriteLine(color); // Выведет: Синий, Красный, Зеленый, Желтый
}
```

**Сравнение коллекций:**

| Коллекция | Принцип работы | Преимущества | Недостатки |
|---|---|---|---|
| Queue (Очередь) | FIFO | Проста в реализации, эффективна для обработки данных в порядке поступления | Не подходит для поиска конкретных элементов |
| Stack (Стек) | LIFO | Проста в реализации, подходит для отслеживания последовательности операций | Не подходит для поиска конкретных элементов |
| LinkedList (Связный список) | Последовательность узлов со ссылками | Эффективен для вставки и удаления элементов в произвольной позиции | Менее эффективен для доступа к элементам по индексу, чем массивы или списки |

Выбор наиболее подходящей коллекции зависит от конкретной задачи и требований к производительности.
