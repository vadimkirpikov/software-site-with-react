## Маршрутизация с параметрами в ASP.NET Core 8.0

Маршрутизация в ASP.NET Core позволяет приложению определять, какой обработчик (метод контроллера) будет вызван для обработки определенного HTTP-запроса. В предыдущих разделах мы рассматривали простую маршрутизацию, где URL-адреса напрямую сопоставлялись с методами действий. 

Однако, часто возникает необходимость создавать более динамические маршруты, которые могут принимать переменные данные. Например, чтобы получить информацию о пользователе по его идентификатору, нам нужен способ передать этот идентификатор в URL-адресе.

###  Параметры маршрута

Параметры маршрута - это именованные заполнители в шаблоне маршрута, которые заменяются фактическими значениями при обработке запроса.  Для определения параметра маршрута используются фигурные скобки `{}`. 

Рассмотрим пример:

```csharp
app.MapGet("/users/{id}", (int id) => $"User ID: {id}");
```

В этом примере `id` - это параметр маршрута. Когда приложение получает запрос на адрес `/users/123`, значение `123` будет передано в метод обработчика в качестве аргумента `id`.

**Типы параметров маршрута**

ASP.NET Core автоматически преобразует строковые значения параметров маршрута в типы данных, указанные в сигнатуре метода обработчика. В предыдущем примере `id` объявлен как `int`, поэтому фреймворк попытается преобразовать значение параметра маршрута в целое число.

**Необязательные параметры маршрута**

Параметры маршрута могут быть необязательными. Для этого используется знак вопроса `?` после имени параметра.

```csharp
app.MapGet("/products/{category?}/{page?}", (string? category, int page = 1) =>
{
    // Логика обработки запроса
});
```

В этом примере и `category`, и `page` являются необязательными. Если в запросе не указаны значения для этих параметров, то `category` будет равен `null`, а `page` будет равен значению по умолчанию, которое равно `1`.

### Ограничения маршрута

Ограничения маршрута позволяют указывать правила для значений параметров маршрута. Например, можно указать, что параметр маршрута должен быть числом, строкой определенной длины или соответствовать регулярному выражению.

Ограничения маршрута указываются в квадратных скобках `[]` после имени параметра.

**Типы ограничений:**

| Ограничение | Описание |
|---|---|
| `[int]` | Параметр должен быть целым числом. |
| `[long]` | Параметр должен быть длинным целым числом. |
| `[float]` | Параметр должен быть числом с плавающей точкой. |
| `[double]` | Параметр должен быть числом с плавающей точкой двойной точности. |
| `[alpha]` | Параметр должен состоять только из букв. |
| `[regex(pattern)]` | Параметр должен соответствовать регулярному выражению. |
| `[range(min, max)]` | Параметр должен находиться в указанном диапазоне. |
| `[minlength(length)]` | Параметр должен иметь минимальную длину. |
| `[maxlength(length)]` | Параметр должен иметь максимальную длину. |

**Пример использования ограничений маршрута:**

```csharp
app.MapGet("/users/{id:int:min(1)}", (int id) => $"User ID: {id}");
```

В этом примере мы указываем, что параметр `id` должен быть целым числом (`int`) и его значение должно быть больше или равно 1 (`min(1)`).

### Создание более сложных маршрутов

Используя комбинацию параметров маршрута, ограничений и других возможностей, можно создавать довольно сложные маршруты, которые соответствуют различным условиям и извлекают необходимые данные из URL-адресов.

**Пример:**

```csharp
app.MapGet("/articles/{year:int:range(2000,2099)}/{month:regex(0[1-9]|1[0-2])}/{slug}",
    (int year, int month, string slug) => $"Article: {year}/{month}/{slug}");
```

В этом примере мы определяем маршрут для получения статьи по году, месяцу и 
названию. Маршрут содержит следующие ограничения:

* `year` -  должен быть целым числом в диапазоне от 2000 до 2099.
* `month` - должен быть строкой, соответствующей регулярному выражению `0[1-9]|1[0-2]`, которое проверяет, что значение месяца находится в диапазоне от 01 до 12.
* `slug` -  принимает любое строковое значение.

### Заключение

Маршрутизация с параметрами - важная часть разработки веб-приложений на ASP.NET Core. Она позволяет создавать гибкие и динамические приложения, которые могут обрабатывать самые разные запросы. Использование параметров маршрута, ограничений и других возможностей маршрутизации позволяет создавать чистый, удобный для понимания и поддерживаемый код. 
