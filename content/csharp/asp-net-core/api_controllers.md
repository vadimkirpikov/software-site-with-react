## Использование контроллеров API в ASP.NET Core 8.0

В этой статье мы рассмотрим контроллеры API - неотъемлемый элемент приложений ASP.NET Core, предназначенных для создания API-интерфейсов. 

### Что такое контроллеры API?

Контроллеры API - это классы C#, которые обрабатывают HTTP-запросы и возвращают ответы клиентам, таким как браузеры, мобильные приложения или другие серверные приложения. Они предоставляют логику для выполнения операций CRUD (создание, чтение, обновление, удаление) с данными, взаимодействия с базами данных, вызова внешних сервисов и многого другого. 

### Создание контроллера API

Чтобы создать контроллер API, выполните следующие действия:

1. **Добавьте новый класс контроллера.**  Для этого можно воспользоваться контекстным меню в Solution Explorer, кликнув правой кнопкой мыши на папку "Controllers" и выбрав "Add" > "Controller...". 

2. **Выберите шаблон "API Controller - Empty"** и нажмите "Add".

3. **Назовите ваш контроллер**, например, `ProductsController`, и нажмите "Add".

В результате будет создан файл `ProductsController.cs` с базовой структурой контроллера:

```csharp
using Microsoft.AspNetCore.Mvc;

namespace MyWebApp.Controllers
{
    [ApiController]
    [Route("api/[controller]")]
    public class ProductsController : ControllerBase
    {

    }
}
```

Разберем код:

-  `using Microsoft.AspNetCore.Mvc;`: импортирует пространство имен `Microsoft.AspNetCore.Mvc`, которое содержит классы и атрибуты, необходимые для создания контроллеров API.
- `namespace MyWebApp.Controllers;`: определяет пространство имен для контроллера.
- `[ApiController]`:  атрибут, применяемый к классу контроллера, указывает, что это контроллер API. 
- `[Route("api/[controller]")]`: атрибут маршрутизации, определяющий базовый URL-адрес для всех действий контроллера. В данном случае URL-адрес будет `api/products`.
- `public class ProductsController : ControllerBase`: определение класса контроллера, который наследуется от `ControllerBase`.

### Создание действия контроллера

Действие контроллера - это метод, который обрабатывает определенный HTTP-запрос. Давайте создадим действие `GetProducts`, которое будет возвращать список продуктов:

```csharp
[HttpGet]
public IEnumerable<string> GetProducts()
{
    return new string[] { "Product 1", "Product 2" };
}
```

В этом коде:

- `[HttpGet]`: атрибут, указывающий, что действие обрабатывает HTTP-запросы GET.
- `public IEnumerable<string> GetProducts()`: определение действия, возвращающего коллекцию строк.

### Запуск и тестирование API

1. **Запустите приложение.**
2. **Откройте браузер** или инструмент для тестирования API, такой как Postman.
3. **Введите URL-адрес вашего API** в адресной строке, например, `https://localhost:7290/api/products` (порт может отличаться).
4. **Отправьте запрос GET.**

В результате вы должны увидеть список продуктов:

```json
[
    "Product 1",
    "Product 2"
]
```

### Маршрутизация и атрибуты HTTP

Для более точной настройки маршрутизации и обработки HTTP-запросов можно использовать следующие атрибуты:

| Атрибут     | Описание                                            |
|------------|----------------------------------------------------|
| `[HttpGet]`  | Обрабатывает HTTP-запросы GET.                   |
| `[HttpPost]` | Обрабатывает HTTP-запросы POST.                  |
| `[HttpPut]`  | Обрабатывает HTTP-запросы PUT.                    |
| `[HttpDelete]` | Обрабатывает HTTP-запросы DELETE.                 |
| `[HttpPatch]` | Обрабатывает HTTP-запросы PATCH.                  |
| `[Route(...)]` | Задает шаблон URL-адреса для действия.             |

### Пример использования атрибутов маршрутизации:

```csharp
[HttpGet("{id}")]
public string GetProductById(int id)
{
    return $"Product with ID: {id}";
}
```

Этот код определяет действие `GetProductById`, которое принимает параметр `id` из URL-адреса и возвращает строку с ID продукта.

### Заключение

В этой статье мы рассмотрели основы использования контроллеров API в ASP.NET Core 8.0. Вы узнали, как создавать контроллеры, действия, использовать атрибуты маршрутизации и HTTP для обработки различных типов запросов. В следующих статьях мы подробнее рассмотрим важные аспекты разработки API, такие как:

* Работа с моделями данных.
* Валидация данных.
* Обработка ошибок.
* Аутентификация и авторизация.
* Документирование API. 
