## Создание форм и их обработка

FastAPI, как и любой другой веб-фреймворк, предоставляет инструменты для работы с формами - одним из основных способов взаимодействия пользователя с веб-приложением. В этом разделе мы разберем, как создавать формы и обрабатывать отправляемые ими данные.

### Библиотека Pydantic и модели форм

FastAPI для работы с формами опирается на мощную библиотеку **Pydantic**.  Pydantic позволяет определить структуру данных с помощью классов-моделей, а также производить валидацию данных.

Создадим простую форму для регистрации пользователя. Для начала определим модель формы с помощью Pydantic:

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()

class User(BaseModel):
    username: str
    email: str
    password: str

```

В этом коде мы определили модель `User`, которая будет описывать данные формы регистрации. Она содержит три поля: `username`, `email` и `password`, каждое из которых является строкой.

### Обработка данных формы

Теперь создадим endpoint, который будет принимать данные формы:

```python
@app.post("/register/")
async def register_user(user: User):
    return {"message": f"Пользователь {user.username} зарегистрирован!"}
```

В этом коде мы определили POST endpoint `/register/`, который принимает один аргумент: `user` типа `User`. FastAPI автоматически обработает запрос, извлечет данные формы и проверит их соответствие модели `User`. 

### Запуск и тестирование

Запустим наше приложение и протестируем его:

```bash
uvicorn main:app --reload
```

Откройте браузер и перейдите по адресу `http://127.0.0.1:8000/docs`. Вы увидите автоматически сгенерированную документацию Swagger UI. В ней найдите endpoint `/register/`, нажмите кнопку "Try it out" и введите данные в форму. После отправки запроса вы увидите ответ сервера с сообщением об успешной регистрации.

### Вывод ошибок валидации

Pydantic автоматически проверяет данные формы на соответствие модели. Если данные некорректны, FastAPI вернет клиенту информативное сообщение об ошибке в формате JSON.

Например, если мы отправим запрос с пустым полем `username`, то получим следующую ошибку:

```json
{
  "detail": [
    {
      "loc": [
        "body",
        "username"
      ],
      "msg": "field required",
      "type": "value_error.missing"
    }
  ]
}
```

### Заключение

Мы рассмотрели базовые возможности FastAPI по работе с формами. С помощью Pydantic мы можем легко определять модели форм, валидировать данные и получать информативные сообщения об ошибках. 

В следующих разделах мы подробнее рассмотрим более сложные сценарии работы с формами, такие как:

* Использование различных типов данных в формах;
* Добавление ограничений и правил валидации;
* Работа с файлами;
* Интеграция с HTML-формами.
