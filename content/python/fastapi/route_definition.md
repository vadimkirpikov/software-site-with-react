## Определение маршрутов и обработчиков

В FastAPI маршрутизация, т.е. определение соответствия между URL-адресом и функцией-обработчиком, является ключевым аспектом. Эта функциональность позволяет вашему приложению реагировать на различные HTTP-запросы, адресованные различным конечным точкам.

### Основы маршрутизации

В основе маршрутизации лежит декоратор `@app.HTTP_метод()`, где `HTTP_метод` - это один из HTTP-глаголов, например, `get`, `post`, `put`, `delete` и т.д. Этот декоратор связывает функцию Python с определенным маршрутом и методом HTTP.

Рассмотрим пример:

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
async def root():
    return {"message": "Привет, мир!"}
```

В этом коде:

- `@app.get("/")` - декоратор, связывающий функцию `root()` с корневым маршрутом (`/`) и методом `GET`.
- `async def root():` - асинхронная функция-обработчик, которая возвращает словарь с приветствием.

Когда ваше приложение получает GET-запрос на `/`, FastAPI вызывает функцию `root()`, которая возвращает JSON-ответ `{"message": "Привет, мир!"}`.

### Параметры пути

Часто вам нужно получать данные из URL-адреса. FastAPI позволяет определять параметры пути, заключая их имя в фигурные скобки в маршруте.

```python
@app.get("/items/{item_id}")
async def read_item(item_id: int):
    return {"item_id": item_id}
```

Здесь `item_id` является параметром пути. FastAPI передает значение этого параметра в функцию `read_item()` в качестве аргумента.

### Типы данных параметров

FastAPI использует аннотации типов Python для объявления типов данных параметров пути. Это обеспечивает автоматическую валидацию данных и генерирует документацию OpenAPI.

В предыдущем примере `item_id: int` указывает, что `item_id` должен быть целым числом. Если запрос содержит неверный тип данных, FastAPI автоматически вернет ошибку 422 (Unprocessable Entity).

### Запросы Query

Помимо параметров пути, вы можете получать данные из строки запроса URL. Для этого используются параметры функции с аннотацией типа.

```python
@app.get("/items/")
async def read_items(q: str = None, skip: int = 0, limit: int = 100):
    return {"q": q, "skip": skip, "limit": limit}
```

В этом примере `q`, `skip` и `limit` - это параметры запроса. Параметры запроса являются необязательными и могут иметь значения по умолчанию.

### Документация API

Одним из преимуществ FastAPI является автоматическая генерация документации API.  Благодаря аннотациям типов и декораторам FastAPI создает интерактивную документацию OpenAPI, доступную по адресу `/docs`. 

### Заключение

Определение маршрутов и обработчиков - это основа для построения API с помощью FastAPI. Комбинируя параметры пути, запросы Query, аннотации типов и декораторы маршрутизации, вы можете создавать мощные и гибкие API с минимальным количеством кода.
