## Установка и использование пакетов

FastAPI, как и любой другой веб-фреймворк, часто используется с дополнительными пакетами для расширения функциональности. В этом разделе мы рассмотрим как устанавливать и использовать внешние пакеты в вашем проекте FastAPI.

### Менеджер пакетов pip

Python использует менеджер пакетов `pip` для установки, обновления и удаления пакетов. Если у вас установлен Python, то скорее всего `pip` уже установлен. Убедиться в этом можно, выполнив команду в терминале:

```bash
pip --version
```

Если `pip` не установлен, следуйте инструкциям на официальном сайте Python для его установки.

### Файл requirements.txt

Хорошей практикой является хранить список всех используемых пакетов в файле `requirements.txt`. Это упрощает развертывание проекта и гарантирует, что на всех машинах будет использоваться одна и та же версия пакетов.

Создайте файл `requirements.txt` в корне вашего проекта и укажите зависимости, например:

```
fastapi==0.111.1
uvicorn[standard]
```

В данном примере мы указываем, что наш проект использует `fastapi` версии `0.111.1` и `uvicorn` со всеми стандартными зависимостями (благодаря `[standard]`).

Чтобы установить все пакеты, перечисленные в `requirements.txt`, выполните команду:

```bash
pip install -r requirements.txt
```

### Пример использования пакета

Давайте рассмотрим пример использования пакета `python-multipart` для обработки multipart/form-data запросов, например, для загрузки файлов.

1. **Установка пакета:**
    ```bash
    pip install python-multipart
    ```

    Добавьте пакет в `requirements.txt`:
    ```
    python-multipart
    ```

2. **Использование пакета в коде:**

    ```python
    from fastapi import FastAPI, File, UploadFile
    from fastapi.responses import HTMLResponse

    app = FastAPI()

    @app.post("/upload/")
    async def upload_file(file: UploadFile = File(...)):
        # Обработка загруженного файла
        contents = await file.read()
        # ...
        return {"filename": file.filename}
    ```

    В этом примере мы импортируем необходимые классы `UploadFile` и `File` из `fastapi`. Функция `upload_file` принимает файл, загруженный пользователем, через параметр `file`. Далее мы можем обработать полученный файл.

### Виртуальные окружения

Рекомендуется использовать виртуальные окружения для каждого проекта Python. Это изолирует зависимости проекта, предотвращая конфликты между пакетами разных проектов.

#### Создание виртуального окружения:

```bash
python -m venv .venv
```

#### Активация виртуального окружения:

**Linux/macOS:**

```bash
source .venv/bin/activate
```

**Windows:**

```bash
.venv\Scripts\activate
```

После активации виртуального окружения все установленные пакеты будут установлены только в нем, не затрагивая глобальную установку Python.

### Заключение

В этом разделе мы рассмотрели основы установки и использования внешних пакетов в проектах FastAPI. Мы узнали о менеджере пакетов `pip`, файле `requirements.txt`, установке пакета `python-multipart` для работы с файлами и использовании виртуальных окружений. Важно понимать, как работать с пакетами, чтобы эффективно расширять функциональность ваших приложений FastAPI. 
