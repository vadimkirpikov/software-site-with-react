## Настройка виртуального окружения для разработки на FastAPI

Перед тем как начать разрабатывать на FastAPI, крайне важно настроить виртуальное окружение для проекта. Виртуальное окружение — это изолированная среда, где устанавливаются все необходимые зависимости для вашего проекта, не затрагивая основную систему или другие проекты.

### Зачем использовать виртуальное окружение?

Использование виртуального окружения решает следующие задачи:

* **Изоляция проекта:** Установка зависимостей в виртуальное окружение не влияет на глобальные пакеты Python, что предотвращает конфликты версий между разными проектами. 
* **Упрощение совместной разработки:** Файл с зависимостями проекта фиксирует точные версии библиотек, используемых в проекте, что обеспечивает идентичную рабочую среду для всех разработчиков.
* **Чистота проекта:** Виртуальное окружение содержит только те пакеты, которые необходимы для вашего проекта, что упрощает его развертывание и управление зависимостями.

### Создание виртуального окружения

Для создания и управления виртуальными окружениями мы будем использовать модуль `venv`, который входит в стандартную библиотеку Python 3. 

**Шаг 1:** Откройте терминал или командную строку и перейдите в директорию, где вы хотите создать свой проект FastAPI.

**Шаг 2:** Выполните следующую команду, чтобы создать виртуальное окружение:

```bash
python3 -m venv .venv
```

Эта команда создаст папку `.venv` в вашем проекте. Внутри этой папки будет находиться копия интерпретатора Python, а также все необходимые инструменты для управления пакетами.

**Примечание:** Вы можете назвать виртуальное окружение как угодно, но рекомендуется использовать имя `.venv`, чтобы оно игнорировалось системой контроля версий (например, Git).

### Активация виртуального окружения

Перед установкой пакетов или запуском кода FastAPI, необходимо активировать виртуальное окружение. 

**Шаг 1:** В терминале выполните следующую команду:

```bash
source .venv/bin/activate
```

**Примечание:**  В Windows команда активации немного отличается:

```bash
.venv\Scripts\activate
```

После активации вы увидите, что имя вашего виртуального окружения появилось в начале строки приглашения терминала, например: `(.venv) user@machine:~/myproject$`. 

### Установка FastAPI и Uvicorn

Теперь, когда виртуальное окружение активировано, мы можем установить FastAPI и Uvicorn:

```bash
pip install fastapi uvicorn[standard]
```

Эта команда установит FastAPI и Uvicorn с необходимыми зависимостями. Uvicorn - это легковесный ASGI-сервер, который мы будем использовать для запуска нашего приложения FastAPI. Опция `[standard]` устанавливает Uvicorn с рекомендуемыми дополнительными пакетами, улучшающими его функциональность.

### Проверка установки

Чтобы проверить, что FastAPI установлен корректно, создайте файл `main.py` в директории вашего проекта и добавьте следующий код:

```python
from fastapi import FastAPI

app = FastAPI()


@app.get("/")
async def root():
    return {"message": "Hello World"}
```

Сохраните файл и запустите приложение FastAPI с помощью Uvicorn:

```bash
uvicorn main:app --reload
```

Этот код запустит сервер разработки Uvicorn, который будет автоматически перезагружаться при изменении кода. `main:app` указывает на файл `main.py` и объект приложения FastAPI `app`.

Теперь откройте браузер и перейдите по адресу `http://127.0.0.1:8000/`. Вы должны увидеть сообщение `{"message": "Hello World"}`. 

### Деактивация виртуального окружения

После завершения работы с проектом вы можете деактивировать виртуальное окружение, выполнив в терминале команду:

```bash
deactivate
```

### Заключение

В этом разделе мы рассмотрели важность использования виртуальных окружений для разработки на FastAPI, а также разобрали шаги по их созданию, активации, установке необходимых пакетов и деактивации. Правильная настройка виртуального окружения является важной частью организации эффективного рабочего процесса разработки и предотвращения потенциальных проблем с совместимостью.
