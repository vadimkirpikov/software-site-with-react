## Параметры маршрутов и запросов в FastAPI

FastAPI предоставляет гибкие возможности для определения параметров маршрутов и обработки различных типов запросов, что делает создание API интуитивно понятным и эффективным.

### Параметры маршрутов

Параметры маршрутов – это переменные, которые являются частью пути URL и позволяют динамически изменять поведение обработчика маршрута.

#### Определение параметров маршрутов

Для определения параметра маршрута заключите его имя в фигурные скобки `{}` в декораторе маршрута:

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/items/{item_id}")
async def read_item(item_id: int):
    return {"item_id": item_id}
```

В этом примере `item_id` является параметром маршрута. FastAPI автоматически передает значение этого параметра из URL в функцию обработчика `read_item` в качестве аргумента.

#### Типы данных параметров маршрутов

FastAPI использует объявления типов Python для проверки и преобразования типов данных параметров маршрутов. В предыдущем примере `item_id: int` указывает, что ожидается параметр типа `int`. FastAPI автоматически преобразует строковое значение из URL в целое число.

#### Необязательные параметры

Чтобы сделать параметр маршрута необязательным, используйте аргумент `None` по умолчанию:

```python
@app.get("/items/{item_id}")
async def read_item(item_id: int = None):
    if item_id:
        return {"item_id": item_id}
    else:
        return {"message": "Item ID not provided"}
```

Теперь маршрут `/items/` без указания `item_id` вернет сообщение "Item ID not provided".

### Параметры запроса

Параметры запроса – это часть URL-адреса, которая следует за знаком вопроса `?`. Они используются для передачи дополнительных данных в запросе, не влияя на сам маршрут.

#### Получение параметров запроса

FastAPI автоматически распознает параметры запроса и передает их в функцию обработчика в виде аргументов:

```python
@app.get("/items/")
async def read_items(skip: int = 0, limit: int = 10):
    return {"skip": skip, "limit": limit}
```

В этом примере `skip` и `limit` являются параметрами запроса. Запрос `/items/?skip=5&limit=20` установит значения `skip=5` и `limit=20`.

#### Типы данных параметров запроса

Как и в случае с параметрами маршрутов, можно указать типы данных для параметров запроса:

```python
@app.get("/items/")
async def read_items(q: str = None, skip: int = 0, limit: int = 10):
    # ...
```

Здесь `q` определен как параметр запроса типа `str`.

#### Валидация параметров запроса

FastAPI поддерживает валидацию параметров запроса с помощью библиотеки Pydantic. Например, можно использовать аннотации типов для ограничения длины строки или диапазона числовых значений:

```python
from fastapi import FastAPI, Query

app = FastAPI()

@app.get("/items/")
async def read_items(
    q: str = Query(None, min_length=3, max_length=50),
    skip: int = Query(0, ge=0, le=100),
    limit: int = Query(10, ge=1, le=100),
):
    # ...
```

В этом примере:

- `q`: необязательный параметр запроса типа `str`, длина которого должна быть от 3 до 50 символов.
- `skip`:  целочисленный параметр запроса, значение которого должно быть в диапазоне от 0 до 100, по умолчанию 0.
- `limit`:  целочисленный параметр запроса, значение которого должно быть в диапазоне от 1 до 100, по умолчанию 10.

#### Документация API

FastAPI автоматически генерирует интерактивную документацию API на основе объявлений типов и аннотаций. Эта документация доступна по адресу `/docs` (Swagger UI) или `/redoc` (ReDoc).

## Заключение

Параметры маршрутов и запросов являются важными инструментами для создания гибких и динамичных API с помощью FastAPI.  Объявления типов Python и аннотации Pydantic делают определение, валидацию и документирование API простым и понятным.
