## Модуль decimal

Модуль `decimal` в Python предоставляет возможность работать с десятичными числами с фиксированной точностью. В отличие от встроенного типа данных `float`, который использует двоичное представление чисел с плавающей точкой, `decimal` работает с десятичными числами, что исключает ошибки округления, свойственные двоичной арифметике.

### Зачем нужен модуль `decimal`?

Рассмотрим простой пример:

```python
>>> 0.1 + 0.2
0.30000000000000004
```

Вместо ожидаемого результата `0.3` мы получаем `0.30000000000000004`. Это связано с тем, что число 0.1 не может быть точно представлено в двоичном виде. Модуль `decimal` решает эту проблему, позволяя работать с десятичными числами напрямую.

```python
>>> from decimal import Decimal
>>> Decimal('0.1') + Decimal('0.2')
Decimal('0.3')
```

### Создание объектов Decimal

Для создания объекта `Decimal` используйте конструктор класса `Decimal()`. Аргументом конструктора может быть:

* Строка, содержащая десятичное число:

```python
>>> Decimal('1.23')
Decimal('1.23')
```

* Целое число:

```python
>>> Decimal(123)
Decimal('123')
```

* Число с плавающей точкой (но это не рекомендуется, так как может привести к неточностям):

```python
>>> Decimal(1.23)
Decimal('1.2300000000000000000000000000000000000000000000000000000000000000000000000002')
```

### Арифметические операции

С объектами `Decimal` можно выполнять все стандартные арифметические операции:

```python
>>> a = Decimal('1.2')
>>> b = Decimal('0.3')
>>> a + b
Decimal('1.5')
>>> a - b
Decimal('0.9')
>>> a * b
Decimal('0.36')
>>> a / b
Decimal('4')
>>> a // b  # Целочисленное деление
Decimal('4')
>>> a % b  # Остаток от деления
Decimal('0.0')
>>> a ** b  # Возведение в степень
Decimal('1.179911060527245896385606291')
```

### Округление

Для округления чисел `Decimal` используется метод `quantize()`. В качестве аргумента методу передается объект `Decimal` с желаемой точностью. 

```python
>>> from decimal import Decimal, ROUND_HALF_UP
>>> Decimal('1.2345').quantize(Decimal('0.01'), ROUND_HALF_UP)
Decimal('1.23')
```

В данном примере число `1.2345` округляется до двух знаков после запятой по правилам округления `ROUND_HALF_UP`.

### Контекст decimal

Модуль `decimal` использует контекст для управления точностью вычислений, округлением и другими настройками. Получить текущий контекст можно с помощью функции `getcontext()`.

```python
>>> from decimal import getcontext
>>> getcontext()
Context(prec=28, rounding=ROUND_HALF_EVEN, Emin=-999999, Emax=999999, capitals=1, clamp=0, flags=[], traps=[InvalidOperation, DivisionByZero, Overflow])
```

Изменить контекст можно с помощью функции `setcontext()` или используя менеджер контекста `localcontext()`.

```python
>>> from decimal import Context, localcontext
>>> with localcontext(Context(prec=10)):
...     print(Decimal(1) / Decimal(3))
0.3333333333
>>> print(Decimal(1) / Decimal(3))  # Точность вернулась к значению по умолчанию
0.3333333333333333333333333333
```

### Заключение

Модуль `decimal` предоставляет мощный инструмент для работы с десятичными числами с высокой точностью. В отличие от типа данных `float`, `decimal` позволяет избежать ошибок округления, что делает его идеальным выбором для финансовых расчетов и других задач, где важна высокая точность.