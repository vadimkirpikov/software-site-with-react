## Кортежи в сопоставлении с образцом

Сопоставление с образцом (pattern matching) в Python, появившееся в версии 3.10, открывает новые горизонты для элегантного и эффективного разбора данных. Одной из структур данных, прекрасно работающих с pattern matching, являются кортежи.

Кортежи, будучи неизменяемыми упорядоченными последовательностями элементов, отлично подходят для представления данных с фиксированной структурой.  Рассмотрим, как использовать pattern matching для работы с кортежами.

### Базовое сопоставление

Простейший случай — проверка на соответствие кортежа заданному образцу:

```python
def process_data(data):
    match data:
        case (1, 2):
            print("Получена пара (1, 2)")
        case (3, 4):
            print("Получена пара (3, 4)")
        case _:
            print("Неизвестные данные")

process_data((1, 2))  # Вывод: Получена пара (1, 2)
process_data((5, 6))  # Вывод: Неизвестные данные
```

В этом примере функция `process_data` принимает кортеж `data`.  Конструкция `match-case` проверяет, соответствует ли `data` одному из заданных кортежей-образцов.  Символ `_` выступает в роли wildcard, захватывая все остальные случаи.

### Извлечение значений

Pattern matching позволяет не только проверять соответствие кортежа образцу, но и извлекать его элементы:

```python
def unpack_point(point):
    match point:
        case (x, y):
            print(f"Координаты точки: x = {x}, y = {y}")

unpack_point((10, 20))  # Вывод: Координаты точки: x = 10, y = 20
```

В данном случае переменные `x` и `y` принимают значения соответствующих элементов кортежа `point`.

### Сложные условия и guard expressions

Мы можем усложнить условия сопоставления, используя guard expressions — дополнительные проверки, выполняемые после сопоставления с образцом:

```python
def analyze_data(data_point):
    match data_point:
        case (temperature, humidity) if temperature > 30 and humidity > 80:
            print("Внимание! Высокая температура и влажность!")
        case (temperature, _) if temperature < 0:
            print("Осторожно! Низкая температура!")
        case _:
            print("Погодные условия в норме.")

analyze_data((35, 90)) # Вывод: Внимание! Высокая температура и влажность!
analyze_data((-5, 50))  # Вывод: Осторожно! Низкая температура!
```

Здесь `if temperature > 30 and humidity > 80` и `if temperature < 0` - guard expressions. Они проверяют дополнительные условия после успешного сопоставления с образцом.

### Сопоставление с произвольным количеством элементов

Pattern matching  также позволяет работать с кортежами переменной длины:

```python
def process_numbers(numbers):
    match numbers:
        case (first, *rest):
            print(f"Первый элемент: {first}, остальные: {rest}")

process_numbers((1, 2, 3, 4))  # Вывод: Первый элемент: 1, остальные: [2, 3, 4]
```

Звездочка (`*`) перед переменной `rest` указывает, что она должна "собрать" все оставшиеся элементы кортежа.

### Вложенные структуры

Pattern matching прекрасно работает с вложенными структурами, позволяя проверять и извлекать данные из кортежей, содержащих другие кортежи:

```python
def process_coordinates(coordinates):
    match coordinates:
        case ((x1, y1), (x2, y2)):
            print(f"Координаты первой точки: ({x1}, {y1})")
            print(f"Координаты второй точки: ({x2}, y2})")

process_coordinates(((10, 20), (30, 40))) 
# Вывод: 
# Координаты первой точки: (10, 20)
# Координаты второй точки: (30, 40)
```

### Использование именованных кортежей

Для большей наглядности кода можно использовать named tuples - кортежи, полям которых можно назначать имена:

```python
from collections import namedtuple

Point = namedtuple('Point', ['x', 'y'])

def calculate_distance(point1, point2):
    match (point1, point2):
        case (Point(x1, y1), Point(x2, y2)):
            distance = ((x2 - x1) ** 2 + (y2 - y1) ** 2) ** 0.5
            print(f"Расстояние между точками: {distance}")

point_a = Point(1, 2)
point_b = Point(4, 6)
calculate_distance(point_a, point_b)  # Вывод: Расстояние между точками: 5.0
```

Здесь мы определяем named tuple `Point` с полями `x` и `y`. Внутри функции `calculate_distance` мы используем имена полей для доступа к координатам точек.

### Заключение

Pattern matching с кортежами - мощный инструмент для лаконичного и эффективного разбора данных.  Он позволяет проверять соответствие сложным структурам, извлекать значения, применять дополнительные условия и работать с данными переменной длины.  Использование pattern matching с кортежами делает код чище, понятнее и легче для поддержки.