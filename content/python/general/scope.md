## Область видимости переменных

В Python, как и во многих других языках программирования,  существует понятие области видимости переменных. Область видимости определяет, из каких частей кода доступна та или иная переменная. Правильное понимание этой концепции критически важно для написания чистого, предсказуемого и  безошибочного кода. 

### Локальная область видимости

Переменные, объявленные внутри функции, обладают локальной областью видимости. Это означает, что они доступны только внутри этой функции.  Попытка обратиться к локальной переменной вне функции приведет к ошибке.

Рассмотрим пример:

```python
def my_function():
    x = 10  # Локальная переменная
    print(f"Значение x внутри функции: {x}")
 
my_function()
print(f"Значение x вне функции: {x}")  # Ошибка!
```

В этом коде переменная `x` объявлена внутри функции `my_function()`.  Она доступна внутри функции, но попытка обратиться к ней вне функции приведет к ошибке `NameError`, так как  `x`  не определена в этой области.

### Глобальная область видимости

Переменные, объявленные вне функций,  имеют глобальную область видимости.  К ним можно получить доступ из любой части кода, как внутри функций, так и вне их. 

Пример:

```python
y = 20 # Глобальная переменная

def my_function():
    print(f"Значение y внутри функции: {y}")

my_function()
print(f"Значение y вне функции: {y}")
```

В этом примере переменная `y` объявлена вне функции, поэтому она глобальна. Мы можем использовать ее как внутри функции `my_function()`, так и вне ее. 

### Изменение глобальных переменных внутри функций

Важно помнить, что Python не позволяет напрямую изменять глобальные переменные внутри функций.  Если мы попытаемся изменить значение глобальной переменной внутри функции, Python создаст новую локальную переменную с тем же именем. 

```python
z = 30  # Глобальная переменная

def change_z():
    z = 40  # Создаётся новая локальная переменная z
    print(f"Значение z внутри функции: {z}")

change_z()
print(f"Значение z вне функции: {z}")
```

В этом коде функция `change_z()` не изменяет значение глобальной переменной `z`. Вместо этого она создает новую локальную переменную с тем же именем.

### Ключевое слово `global`

Для изменения значения глобальной переменной внутри функции необходимо использовать ключевое слово `global`:

```python
a = 50  # Глобальная переменная

def change_a():
    global a  # Используем ключевое слово global
    a = 60  # Изменяем значение глобальной переменной a
    print(f"Значение a внутри функции: {a}")

change_a()
print(f"Значение a вне функции: {a}") 
```

В этом примере мы использовали ключевое слово `global` внутри функции `change_a()`, чтобы указать, что мы работаем с глобальной переменной `a`.  Теперь функция изменяет значение глобальной переменной.

### Вложенные функции и области видимости

Python позволяет создавать функции внутри других функций.  В этом случае действуют те же правила областей видимости, но с некоторыми особенностями. Вложенная функция имеет доступ к переменным из своей локальной области видимости,  а также из области видимости родительской функции.  

Рассмотрим пример:

```python
def outer_function():
    b = 100  # Переменная в области видимости outer_function

    def inner_function():
        print(f"Значение b внутри inner_function: {b}")  # Доступ к b из outer_function

    inner_function() 

outer_function() 
```

В этом коде функция `inner_function` определена внутри функции `outer_function`. 
`inner_function`  имеет доступ к переменной `b`, которая определена в  области видимости  `outer_function`.

### Ключевое слово `nonlocal`

Для изменения значения переменной из области видимости родительской функции внутри вложенной функции используется ключевое слово `nonlocal`.  

Пример:

```python
def outer_function():
    c = 200 

    def inner_function():
        nonlocal c  # Используем nonlocal для доступа к c из outer_function
        c = 300 
        print(f"Значение c внутри inner_function: {c}") 

    inner_function()
    print(f"Значение c внутри outer_function после вызова inner_function: {c}")

outer_function()
```

В этом примере  `inner_function`  использует  `nonlocal`, чтобы получить доступ к  `c`  из области  `outer_function`  и изменить ее значение.

### Заключение

Понимание принципов работы области видимости переменных в Python –  важная часть изучения языка.  Правильное использование локальных и глобальных переменных,  а также ключевых слов `global`  и  `nonlocal`,  делает код более чистым,  читаемым и  предотвращает  потенциальные ошибки. 
