<h2>Использование шаблонных тегов и фильтров в Django</h2>

Шаблонные теги и фильтры — это мощные инструменты Django, которые позволяют динамически изменять вывод HTML-кода. Теги и фильтры предоставляют простой и удобный способ добавления логики и манипулирования данными непосредственно в шаблонах.

<h3>Шаблонные теги</h3>

Шаблонные теги представляют собой специальные конструкции, заключенные в фигурные скобки с символами процента (`{% ... %}`). Они позволяют выполнять различные действия, такие как:

* Управление потоком выполнения (циклы, условия).
* Вызов функций Python.
* Наследование шаблонов.

<h4>Пример использования шаблонного тега</h4>

```html
<h1>Список статей</h1>
<ul>
{% for article in articles %}
  <li>{{ article.title }}</li>
{% endfor %}
</ul>
```

В этом примере тег `{% for %}` используется для итерации по списку `articles` и вывода заголовка каждой статьи.

<h3>Шаблонные фильтры</h3>

Шаблонные фильтры применяются к переменным или результатам вызова функций внутри двойных фигурных скобок (`{{ ... }}`). Фильтры позволяют изменять значения перед их отображением, например:

* Форматирование дат и чисел.
* Изменение регистра текста.
* Обрезка строк.

<h4>Пример использования шаблонного фильтра</h4>

```html
<p>Дата публикации: {{ article.pub_date|date:"d.m.Y" }}</p>
```

В этом примере фильтр `date` используется для форматирования даты публикации статьи в формате "день.месяц.год".

<h3>Встроенные теги и фильтры</h3>

Django предоставляет обширный набор встроенных тегов и фильтров, которые покрывают большинство распространенных задач. Вот некоторые из них:

**Теги:**

* `{% if %}` - Условное выполнение блока кода.
* `{% for %}` - Цикл по итерируемому объекту.
* `{% include %}` - Вставка другого шаблона.
* `{% block %}` - Определение и переопределение блоков в наследуемых шаблонах.
* `{% load %}` - Загрузка пользовательских тегов и фильтров.

**Фильтры:**

* `date` - Форматирование даты.
* `length` - Получение длины объекта.
* `upper` - Преобразование текста в верхний регистр.
* `lower` - Преобразование текста в нижний регистр.
* `truncatechars` - Обрезка строки до заданного количества символов.

<h3>Создание собственных тегов и фильтров</h3>

Помимо встроенных тегов и фильтров, Django позволяет создавать собственные. Это полезно, когда требуется реализовать специфичную для проекта логику.

<h4>Создание пользовательского фильтра</h4>

Для создания пользовательского фильтра необходимо выполнить следующие шаги:

1. Создайте файл `templatetags` в директории вашего приложения.
2. Создайте файл Python внутри директории `templatetags` (например, `my_tags.py`).
3. Зарегистрируйте библиотеку тегов, добавив в начало файла `my_tags.py`:
```python
from django import template

register = template.Library()
```
4. Определите функцию Python, которая будет реализовывать логику фильтра.
5. Зарегистрируйте функцию как фильтр, используя декоратор `@register.filter`.

**Пример:**

```python
# my_app/templatetags/my_tags.py

from django import template

register = template.Library()

@register.filter
def add_class(value, arg):
    """Добавляет CSS-класс к HTML-тегу."""
    return value.as_widget(attrs={'class': arg})
```

<h4>Использование пользовательского фильтра</h4>

Чтобы использовать пользовательский фильтр в шаблоне, сначала нужно загрузить библиотеку тегов:

```html
{% load my_tags %}
```

Затем можно использовать фильтр как обычно:

```html
<form>
  {{ form.name|add_class:"form-control" }}
  <button type="submit">Отправить</button>
</form>
```

В этом примере фильтр `add_class` добавляет класс "form-control" к полю ввода имени.

Создание собственных тегов и фильтров - это мощный способ расширить возможности шаблонов Django. 

**Важно помнить:**

* Логика шаблонов должна быть максимально простой. Сложные операции лучше выполнять в Python-коде, а в шаблоны передавать уже обработанные данные.
* При создании собственных тегов и фильтров необходимо следить за безопасностью и избегать использования кода, который может быть уязвим для XSS-атак.
