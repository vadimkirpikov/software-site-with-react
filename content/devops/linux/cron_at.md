## Автоматизация задач с использованием cron и at

В Linux существует возможность автоматизировать выполнение задач, что позволяет экономить время и повысить эффективность работы. Два основных инструмента для этого – **cron** и **at**. 

**Cron** используется для планирования задач, которые необходимо выполнять регулярно, например, каждый день, неделю или месяц. **At**, с другой стороны, предназначен для однократного запуска задачи в определенное время.

### Работа с cron

Cron работает с файлом **crontab**, в котором хранятся инструкции по планированию задач для каждого пользователя. 

#### Просмотр и редактирование crontab

Для просмотра своего файла crontab используйте команду:

```bash
crontab -l
```

Если файл пуст, вы увидите сообщение "no crontab for user".

Чтобы отредактировать crontab, выполните:

```bash
crontab -e
```

Откроется текстовый редактор (по умолчанию - nano), в котором можно добавлять, изменять и удалять задания.

#### Синтаксис crontab

Каждая строка в crontab представляет собой отдельное задание и имеет следующий синтаксис:

```
минуты часы день_месяца месяц день_недели команда
```

**Значения полей:**

| Поле | Допустимые значения | Описание |
|---|---|---|
| минуты | 0-59 | Минута запуска задания (0 - начало часа) |
| часы | 0-23 | Час запуска задания (0 - полночь) |
| день_месяца | 1-31 | День месяца |
| месяц | 1-12 | Месяц года |
| день_недели | 0-7 | День недели (0 и 7 - воскресенье) |
| команда |  | Команда или скрипт для выполнения |

**Специальные символы:**

| Символ | Описание |
|---|---|
| * |  Запускать задание каждый период времени (минута, час, день и т.д.) |
| , |  Разделяет несколько значений |
| - |  Задает диапазон значений |
| / |  Задает интервал |

**Примеры:**

* Запуск скрипта `backup.sh` каждый день в 3 часа утра:

```
0 3 * * * /path/to/backup.sh
```

* Запуск команды `updatedb` каждый час:

```
0 * * * * updatedb
```

* Запуск команды `rm -rf /tmp/*` каждый понедельник в 5:30 утра:

```
30 5 * * 1 rm -rf /tmp/*
```

#### Перенаправление вывода

По умолчанию вывод команд, запущенных через cron, отправляется на почтовый ящик пользователя. 

Для перенаправления вывода в файл используйте оператор `>`:

```
0 0 * * * /path/to/script.sh > /var/log/script.log 2>&1
```

В данном примере, стандартный вывод (stdout) и стандартный вывод ошибок (stderr) перенаправляются в файл `/var/log/script.log`.

### Работа с at

**At** используется для однократного запуска команд или скриптов в определенное время.

#### Запуск команд с помощью at

Для запуска команды с помощью at используйте команду `at` followed by the desired execution time:

```bash
at 10:00 tomorrow
```

Откроется текстовый редактор, в котором нужно ввести команду или скрипт для выполнения. 

Для выхода из редактора нажмите `Ctrl+D`.

**Форматы времени:**

* `now`: текущее время
* `midnight`: полночь
* `noon`: полдень
* `teatime`: 16:00
* `+`:  через (например, `+1 hour`, `+3 days`)

#### Просмотр очереди at

Для просмотра списка запланированных заданий используйте команду:

```bash
atq
```

#### Удаление заданий из очереди

Чтобы удалить задание из очереди, используйте команду `atrm` followed by the job ID:

```bash
atrm <job_id>
```

#### Пример

Запуск скрипта `send_report.sh` завтра в 8:00:

```bash
echo "/path/to/send_report.sh" | at 08:00 tomorrow
```

### Заключение

Использование cron и at позволяет автоматизировать рутинные задачи в Linux, освобождая время для более важных дел. Важно помнить о безопасности при использовании данных инструментов, особенно при запуске команд от имени суперпользователя (root). 
