## Интерактивная перепись истории коммитов

Интерактивная перепись истории коммитов - это мощный инструмент в Git, который позволяет вам изменять коммиты, уже добавленные в историю вашего репозитория. С его помощью можно редактировать сообщения коммитов, разбивать один коммит на несколько, объединять несколько коммитов в один, изменять порядок коммитов и даже удалять ненужные. Эта функциональность особенно полезна, когда вы готовитесь отправить изменения в общий репозиторий и хотите представить свою работу в наиболее понятном и структурированном виде.

### Команда `git rebase -i`

Основной инструмент для интерактивной переписки истории - это команда `git rebase` с опцией `-i` (интерактивный). Она запускает интерактивный режим, в котором вы можете выбрать, какие действия выполнить над каждым коммитом.

```
git rebase -i <commit>
```

Вместо `<commit>` нужно указать коммит, **до** которого вы хотите переписать историю. Например, `HEAD~3` указывает на коммит, находящийся на 3 коммита позади текущего.

### Действия в интерактивном режиме

После запуска команды `git rebase -i` откроется текстовый редактор (обычно Vim или Nano) с списком коммитов, которые будут подвергнуты переписыванию.  Каждый коммит представлен строкой, содержащей:

* Команду, которую нужно выполнить с этим коммитом (по умолчанию `pick`)
* Хеш коммита
* Сообщение коммита

Доступны следующие команды:

| Команда | Описание |
|---|---|
| **p, pick** | Применить коммит без изменений |
| **r, reword** | Изменить сообщение коммита |
| **e, edit** | Изменить коммит (сообщение и/или файлы) |
| **s, squash** | Объединить коммит с предыдущим |
| **f, fixup** | Объединить коммит с предыдущим, используя сообщение предыдущего коммита |
| **d, drop** | Удалить коммит |

### Примеры использования

#### 1. Изменение сообщения коммита

Чтобы изменить сообщение коммита, замените команду `pick` на `reword` для нужного коммита в списке. Сохраните файл и закройте редактор. Git запустит редактирование сообщения коммита. Внесите необходимые изменения и сохраните файл.

```
pick 1234567 Первый коммит
reword abcdefg Второй коммит
pick 7654321 Третий коммит
```

#### 2. Разбиение коммита на два

Чтобы разбить коммит на два, замените команду `pick` на `edit` для нужного коммита. Сохраните файл и закройте редактор. Git остановится на этом коммите. 

1. Используйте `git reset HEAD~` чтобы отменить изменения, внесенные этим коммитом. 
2. Добавьте нужные изменения в индекс с помощью `git add`.
3. Создайте новый коммит с помощью `git commit -m "Новое сообщение"`.
4. Повторите шаги 2-3 для создания второго коммита.
5. Запустите `git rebase --continue` чтобы продолжить процесс переписывания истории.

#### 3. Объединение коммитов

Чтобы объединить несколько коммитов в один, замените команду `pick` на `squash` для всех коммитов, которые нужно объединить с предыдущим. Сохраните файл и закройте редактор. Git откроет редактор с сообщениями всех объединенных коммитов. Отредактируйте сообщение для нового объединенного коммита и сохраните файл.

```
pick 1234567 Первый коммит
squash abcdefg Второй коммит
squash 7654321 Третий коммит
```

### Важно помнить

* Переписывание истории **изменяет хеши коммитов**. Не используйте `git rebase -i` для коммитов, которые уже были отправлены в общий репозиторий, если вы не уверены в своих действиях.
* После переписывания истории вам нужно будет принудительно отправить изменения в общий репозиторий с помощью `git push --force`.
* Перед использованием `git rebase -i` рекомендуется создать резервную копию ветки, с которой вы работаете.

Интерактивная перепись истории коммитов - это мощный инструмент, который может сделать вашу историю коммитов более чистой и понятной. Используйте его с осторожностью и только после того, как вы разберетесь, как он работает. 
