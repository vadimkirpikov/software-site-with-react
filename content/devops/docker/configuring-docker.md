## Настройка Docker

После успешной установки Docker на вашу систему, рекомендуется выполнить базовую настройку, которая оптимизирует работу и повысит уровень безопасности. В этом разделе мы рассмотрим основные параметры конфигурации Docker и приведем примеры их настройки.

### Конфигурационный файл Docker

Docker использует конфигурационный файл **daemon.json**, который хранится в формате JSON. Этот файл позволяет управлять различными аспектами работы Docker Engine. 

Расположение файла **daemon.json**:

- Linux: `/etc/docker/daemon.json`
- Windows: `C:\ProgramData\Docker\config\daemon.json`

Если файл отсутствует, его необходимо создать.

### Основные параметры конфигурации

#### 1. Реестр образов

По умолчанию Docker использует Docker Hub как основной реестр образов. Вы можете указать дополнительные реестры или настроить приватные реестры для хранения своих образов. 

Пример настройки дополнительных реестров в **daemon.json**:

```json
{
  "insecure-registries": ["my-registry.example.com:5000"]
}
```

**Важно!**: Использование незащищенных реестров (без HTTPS) может представлять угрозу безопасности.

#### 2. Ограничение ресурсов

Docker позволяет ограничивать ресурсы (CPU, память, дисковое пространство), доступные для контейнеров. Это позволяет избежать ситуации, когда один контейнер потребляет все ресурсы системы.

Пример ограничения ресурсов в **daemon.json**:

```json
{
  "default-runtime-settings": {
    "cpus": 2,
    "memory": "2G",
    "pids-limit": 1000
  }
}
```

В этом примере мы ограничиваем контейнеры по умолчанию:

- **cpus**: 2 ядра CPU
- **memory**: 2 гигабайта оперативной памяти
- **pids-limit**: 1000 процессов

#### 3. Логирование

Docker поддерживает различные драйверы логирования, которые позволяют сохранять и управлять логами контейнеров.

Пример настройки драйвера логирования `json-file` в **daemon.json**:

```json
{
  "log-driver": "json-file",
  "log-opts": {
    "max-size": "10m",
    "max-file": "3"
  }
}
```

В этом примере мы:

- указываем драйвер логирования `json-file`
- ограничиваем размер каждого файла логов до 10 мегабайт
- ограничиваем количество файлов логов до 3

#### 4. Сеть

Docker позволяет настраивать сетевые параметры, такие как DNS-серверы, диапазоны IP-адресов и драйверы сети.

Пример настройки DNS-серверов в **daemon.json**:

```json
{
  "dns": ["8.8.8.8", "8.8.4.4"]
}
```

#### 5. Прокси

Если ваш сервер находится за прокси-сервером, необходимо настроить Docker для работы через прокси.

Пример настройки прокси-сервера в **daemon.json**:

```json
{
  "proxies":
  {
    "default":
    {
      "httpProxy": "http://proxy.example.com:3128",
      "httpsProxy": "https://proxy.example.com:3128",
      "noProxy": "localhost,127.0.0.1,.example.com"
    }
  }
}
```

**Важно!**: После изменения конфигурационного файла **daemon.json** необходимо перезапустить Docker Engine, чтобы применить изменения.

### Применение настроек

Для применения настроек из файла **daemon.json** необходимо перезапустить Docker Engine.

**Linux**:

```bash
sudo systemctl restart docker
```

**Windows**:

Перезапустите службу Docker из панели управления службами.

### Заключение

Настройка Docker - важный шаг, который позволяет оптимизировать производительность, повысить безопасность и адаптировать Docker под ваши нужды. Используйте представленные примеры как отправную точку для настройки Docker на вашей системе.