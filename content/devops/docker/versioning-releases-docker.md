## Управление версиями и релизами в Docker

В процессе разработки Docker-образов, особенно в командной работе, важно эффективно управлять версиями и релизами. Это упрощает отслеживание изменений, возврат к предыдущим версиям и выпуск стабильных версий приложения. В этой статье мы рассмотрим, как использовать теги Docker для управления версиями образов и организовать эффективный процесс релизов.

### Теги Docker

Теги - это алиасы, которые мы присваиваем Docker-образам для их идентификации. Они позволяют различать различные версии одного и того же образа, например, `my-app:1.0.0` или `my-app:latest`.

**Синтаксис тегов:**

```
[РЕГИСТР]/[ИМЯ_ОБРАЗА]:[ТЕГ]
```

- **РЕГИСТР**: Опциональный параметр. Указывает на реестр Docker, где хранится образ (например, `docker.io` для Docker Hub).
- **ИМЯ_ОБРАЗА**: Имя образа, которое мы задали при его сборке.
- **ТЕГ**: Собственно, тег, который мы хотим присвоить образу.

**Примеры тегов:**

| Тег | Описание |
|---|---|
| `latest` | По умолчанию используется для последней версии образа. |
| `1.0.0` | Тег с семантической версией. |
| `production` | Тег для продакшн-версии образа. |
| `feature-xyz` | Тег для образа с новой функциональностью. |

### Семантическое версионирование

Для управления версиями образов рекомендуется использовать [семантическое версирование](https://semver.org/lang/ru/). Согласно этому стандарту, версия приложения состоит из трех чисел: **MAJOR.MINOR.PATCH**, где:

- **MAJOR**: Увеличивается при внесении несовместимых изменений API.
- **MINOR**: Увеличивается при добавлении новой функциональности, сохраняя обратную совместимость.
- **PATCH**: Увеличивается при исправлении ошибок, сохраняя обратную совместимость.

**Пример:**

```
my-app:1.0.0  # Первая стабильная версия
my-app:1.1.0  # Добавлена новая функция
my-app:1.1.1  # Исправлена ошибка в версии 1.1.0
my-app:2.0.0  # Внесены изменения, ломающие обратную совместимость
```

### Управление тегами

**1. Присвоение тега при сборке образа:**

```bash
docker build -t my-app:1.0.0 .
```

**2. Переименование тега:**

```bash
docker tag my-app:latest my-app:1.0.0
```

**3. Удаление тега:**

```bash
docker rmi my-app:1.0.0
```

### Релизы

Релиз - это стабильная версия приложения, готовая к развертыванию в production. При организации релизов в Docker рекомендуется:

1. **Использовать отдельный тег для production-релизов**, например, `production` или `release`.
2. **Создавать релизные теги только для протестированных и стабильных версий**.
3. **Вести журнал релизов** с описанием изменений и версий.

**Пример:**

```bash
# Сборка образа с тегом 1.0.0
docker build -t my-app:1.0.0 .

# Тестирование версии 1.0.0

# Присвоение тега production для релиза
docker tag my-app:1.0.0 my-app:production

# Загрузка образа в реестр
docker push my-registry/my-app:production
```

### Заключение

В этой статье мы рассмотрели основные принципы управления версиями и релизами Docker-образов. Использование тегов и семантического версионирования позволяет создавать понятную и управляемую структуру образов, упрощает командную работу и обеспечивает надежное развертывание приложений. 
