## Основы запросов в MongoDB

В этой статье мы рассмотрим основы выполнения запросов к базе данных MongoDB. Вы узнаете, как искать документы по заданным критериям, сортировать результаты, ограничивать количество возвращаемых документов и проецировать нужные поля.

### Подключение к базе данных

Перед тем как начать работать с запросами, необходимо подключиться к базе данных MongoDB. Это можно сделать с помощью предпочитаемого вами драйвера MongoDB.

### Базовая структура запроса

Основным методом для выполнения запросов в MongoDB является `find()`. Он принимает два аргумента:

* **Фильтр (query):**  Документ JSON, определяющий критерии поиска.
* **Проекция (projection):**  Документ JSON, определяющий, какие поля следует включить или исключить из результатов.

```javascript
db.collectionName.find(filter, projection)
```

### Поиск документов

#### Поиск по точному совпадению

Чтобы найти документы, в которых значение поля точно соответствует заданному значению, используйте следующий синтаксис:

```javascript
db.users.find({"name": "John"}) // Найти всех пользователей с именем "John"
```

#### Поиск с операторами сравнения

MongoDB предоставляет следующие операторы сравнения:

| Оператор | Описание                                    |
|----------|---------------------------------------------|
| `$eq`     | Равно                                        |
| `$ne`     | Не равно                                     |
| `$gt`     | Больше                                       |
| `$gte`    | Больше или равно                              |
| `$lt`     | Меньше                                      |
| `$lte`    | Меньше или равно                             |

Пример использования оператора `$gt`:

```javascript
db.products.find({"price": { "$gt": 100 }}) // Найти все товары с ценой больше 100
```

#### Логические операторы

Для объединения нескольких условий в запросе можно использовать логические операторы:

| Оператор | Описание                                          |
|----------|--------------------------------------------------- |
| `$and`    | Возвращает документы, соответствующие всем условиям |
| `$or`     | Возвращает документы, соответствующие хотя бы одному условию |
| `$not`    | Возвращает документы, не соответствующие условию  |

Пример использования оператора `$and`:

```javascript
db.orders.find({
    "$and": [
        {"status": "completed"}, // Найти заказы со статусом "completed"
        {"total": { "$gt": 50 }} // и суммой заказа больше 50
    ]
}) 
```

### Сортировка результатов

Для сортировки результатов запроса используется метод `sort()`. 

```javascript
db.collectionName.find().sort(sortCriteria)
```

`sortCriteria` - это документ, где ключи - это поля для сортировки, а значения - порядок сортировки:

* **1:** Сортировка по возрастанию
* **-1:** Сортировка по убыванию

Пример:

```javascript
db.products.find().sort({"price": -1}) // Сортировка товаров по цене по убыванию
```

### Ограничение количества результатов

Для ограничения количества возвращаемых документов используется метод `limit()`.

```javascript
db.collectionName.find().limit(limit)
```

`limit` - это целое число, определяющее максимальное количество возвращаемых документов.

Пример:

```javascript
db.users.find().limit(10) // Вернуть только 10 пользователей
```

### Проекция полей

Для выбора определенных полей из документов используется второй аргумент метода `find()`.

```javascript
db.collectionName.find(filter, projection)
```

`projection` - это документ, где ключи - это поля, а значения:

* **1:** Включить поле в результат
* **0:** Исключить поле из результата

Пример:

```javascript
db.products.find({}, {"name": 1, "price": 1, "_id": 0}) // Вернуть только имя и цену товара, исключая поле "_id"
```

## Заключение

В этой статье мы рассмотрели основы выполнения запросов в MongoDB. Вы научились искать документы по заданным критериям, сортировать результаты, ограничивать количество возвращаемых документов и выбирать нужные поля. 
