## Основы администрирования

MongoDB - это NoSQL база данных, которая популярна благодаря своей гибкости и масштабируемости. Она позволяет хранить данные в виде документов JSON, что обеспечивает удобство работы с данными и повышает производительность. 

Администрирование MongoDB включает в себя управление базами данных, пользователями, ролями, а также обеспечение безопасности и стабильности работы системы. 

### Установка и запуск

Для установки MongoDB 7.0, скачайте пакет с официального сайта и следуйте инструкциям по установке для вашей операционной системы.

**Запуск MongoDB:**

Для запуска MongoDB в Linux или macOS используйте команду:

```bash
mongod
```

Для запуска MongoDB в Windows используйте команду:

```bash
mongod.exe
```

### Подключение к MongoDB

Для подключения к MongoDB используйте инструмент командной строки **mongo**. 

**Запуск mongo:**

```bash
mongo
```

**Подключение к серверу:**

```bash
mongo <адрес_сервера>:<порт>
```

**Пример:**

```bash
mongo localhost:27017
```

### Базы данных

MongoDB работает с базами данных, которые являются контейнерами для коллекций.

**Создание базы данных:**

```javascript
use <имя_базы_данных>
```

**Пример:**

```javascript
use myDatabase
```

**Проверка существования базы данных:**

```javascript
show dbs
```

**Удаление базы данных:**

```javascript
db.dropDatabase()
```

### Коллекции

Коллекции - это хранилища для документов JSON в MongoDB.

**Создание коллекции:**

```javascript
db.createCollection(<имя_коллекции>)
```

**Пример:**

```javascript
db.createCollection('users')
```

**Просмотр списка коллекций:**

```javascript
show collections
```

**Удаление коллекции:**

```javascript
db.dropCollection(<имя_коллекции>)
```

### Документы

Документы - это единицы данных в MongoDB. Они хранятся в виде JSON объектов.

**Вставка документа:**

```javascript
db.<имя_коллекции>.insertOne({<ключ1>: <значение1>, <ключ2>: <значение2>, ...})
```

**Пример:**

```javascript
db.users.insertOne({name: 'John Doe', age: 30, city: 'New York'})
```

**Чтение документа:**

```javascript
db.<имя_коллекции>.findOne({<условие>})
```

**Пример:**

```javascript
db.users.findOne({name: 'John Doe'})
```

**Обновление документа:**

```javascript
db.<имя_коллекции>.updateOne({<условие>}, {$set: {<ключ>: <новое_значение>}})
```

**Пример:**

```javascript
db.users.updateOne({name: 'John Doe'}, {$set: {age: 31}})
```

**Удаление документа:**

```javascript
db.<имя_коллекции>.deleteOne({<условие>})
```

**Пример:**

```javascript
db.users.deleteOne({name: 'John Doe'})
```

### Индексы

Индексы - это специальные структуры данных, которые ускоряют поиск и сортировку документов.

**Создание индекса:**

```javascript
db.<имя_коллекции>.createIndex({<ключ>: 1})
```

**Пример:**

```javascript
db.users.createIndex({name: 1})
```

**Удаление индекса:**

```javascript
db.<имя_коллекции>.dropIndex({<имя_индекса>})
```

**Пример:**

```javascript
db.users.dropIndex('name_1')
```

### Запросы

MongoDB предоставляет богатый набор возможностей для запросов к данным.

**Простые запросы:**

```javascript
db.<имя_коллекции>.find({<условие>})
```

**Пример:**

```javascript
db.users.find({age: 30})
```

**Использование операторов:**

```javascript
db.<имя_коллекции>.find({<ключ>: {$gt: <значение>}})
```

**Пример:**

```javascript
db.users.find({age: {$gt: 30}})
```

**Проекция:**

```javascript
db.<имя_коллекции>.find({<условие>}, {<ключ1>: 1, <ключ2>: 1})
```

**Пример:**

```javascript
db.users.find({age: 30}, {name: 1, city: 1})
```

### Агрегация

Агрегация позволяет выполнять сложные операции над данными, такие как группировка, сортировка и вычисления.

**Пример:**

```javascript
db.users.aggregate([
  { $group: { _id: '$city', count: { $sum: 1 } } },
  { $sort: { count: -1 } }
])
```

**Результат:**

```json
[
  { "_id" : "New York", "count" : 2 },
  { "_id" : "London", "count" : 1 }
]
```

### Безопасность

MongoDB предоставляет функции для обеспечения безопасности данных.

**Создание пользователей:**

```javascript
db.createUser({
  user: '<имя_пользователя>',
  pwd: '<пароль>',
  roles: [
    { role: '<роль>', db: '<имя_базы_данных>' }
  ]
})
```

**Пример:**

```javascript
db.createUser({
  user: 'admin',
  pwd: 'password',
  roles: [
    { role: 'readWrite', db: 'myDatabase' }
  ]
})
```

**Аутентификация:**

```javascript
use <имя_базы_данных>
db.auth('<имя_пользователя>', '<пароль>')
```

**Пример:**

```javascript
use myDatabase
db.auth('admin', 'password')
```

### Репликация

Репликация - это механизм для повышения доступности и отказоустойчивости MongoDB.

**Настройка репликации:**

```bash
mongod --replSet <имя_реплики> --port <порт> --dbpath <путь_к_данным>
```

**Пример:**

```bash
mongod --replSet rs0 --port 27017 --dbpath /data/db
```

**Добавление серверов в реплику:**

```bash
rs.add('<адрес_сервера>:<порт>')
```

**Пример:**

```bash
rs.add('server2:27017')
```

### Мониторинг

Мониторинг MongoDB позволяет отслеживать состояние базы данных и своевременно выявлять проблемы.

**Использование инструментов:**

* **mongostat:** выводит статистику о производительности
* **mongotop:** отображает активные операции в реальном времени
* **db.serverStatus():** возвращает подробную информацию о состоянии сервера
* **db.currentOp():** отображает активные операции

### Заключение

Администрирование MongoDB - это комплексный процесс, который требует  понимания ключевых концепций, таких как базы данных, коллекции, документы, индексы, запросы и безопасность.  

Данный раздел предоставляет краткий обзор основных принципов администрирования MongoDB.  В дальнейшем вы можете изучить более продвинутые аспекты,  такие как репликация, sharding,  безопасность и мониторинг.  
