## Роли и права доступа

В Neo4j управление доступом к данным осуществляется с помощью системы ролей и прав. Роли представляют собой предопределенные наборы прав, которые можно назначать пользователям для ограничения их доступа к определенным операциям с данными. Права, в свою очередь, определяют, какие операции могут выполнять пользователи с определенными объектами, такими как узлы, ребра или свойства.

### Создание ролей

Для создания роли в Neo4j используйте команду `CREATE ROLE`:

```cypher
CREATE ROLE role_name;
```

**Пример:**

```cypher
CREATE ROLE admin; // Создание роли 'admin'
```

### Назначение прав ролям

Для назначения прав роли используйте команду `GRANT`:

```cypher
GRANT privilege ON resource TO role_name;
```

**Параметры:**

* `privilege`: Право, которое нужно назначить.
* `resource`: Ресурс, к которому применяется право.
* `role_name`: Имя роли, которой назначается право.

**Типы прав:**

* `READ`: Чтение данных.
* `CREATE`: Создание узлов, ребер и свойств.
* `UPDATE`: Обновление данных.
* `DELETE`: Удаление данных.
* `DROP`: Удаление ресурсов.
* `ALL`: Все права.

**Типы ресурсов:**

* `NODE`: Узлы.
* `RELATIONSHIP`: Ребра.
* `PROPERTY`: Свойства.
* `DATABASE`: База данных.
* `SCHEMA`: Схема базы данных.
* `ALL`: Все ресурсы.

**Пример:**

```cypher
GRANT READ ON NODE TO admin; // Предоставление права чтения узлов роли 'admin'
GRANT CREATE ON NODE TO admin; // Предоставление права создания узлов роли 'admin'
GRANT ALL ON DATABASE TO admin; // Предоставление всех прав на базу данных роли 'admin'
```

### Назначение ролей пользователям

Для назначения роли пользователю используйте команду `SET`:

```cypher
SET USER user_name ROLE role_name;
```

**Пример:**

```cypher
SET USER neo4j ROLE admin; // Назначение роли 'admin' пользователю 'neo4j'
```

### Отзыв прав и ролей

Для отзыва прав от роли используйте команду `REVOKE`:

```cypher
REVOKE privilege ON resource FROM role_name;
```

**Пример:**

```cypher
REVOKE READ ON NODE FROM admin; // Отзыв права чтения узлов от роли 'admin'
```

Для отзыва роли от пользователя используйте команду `SET`:

```cypher
SET USER user_name ROLE NONE;
```

**Пример:**

```cypher
SET USER neo4j ROLE NONE; // Отзыв всех ролей от пользователя 'neo4j'
```

### Предопределенные роли

В Neo4j существует ряд предопределенных ролей с различными наборами прав:

| Роль | Описание |
|---|---|
| `admin` | Полный доступ ко всем ресурсам. |
| `reader` | Чтение данных. |
| `writer` | Создание, обновление и удаление данных. |
| `dbms` | Управление базой данных. |
| `system` | Доступ к системным ресурсам. |

### Пример использования ролей и прав доступа

Рассмотрим пример, как можно использовать роли и права доступа для управления доступом к данным в Neo4j. 

Предположим, у нас есть база данных с узлами типа `Person` и `Company`, и мы хотим создать две роли: `employee` и `manager`. 

* **Роль `employee`** сможет читать информацию о `Person`, но не сможет изменять ее. Также `employee` сможет читать информацию о `Company`, если у нее есть отношение `WORKS_AT` с узлом `Person`.
* **Роль `manager`** сможет читать, создавать, обновлять и удалять информацию о `Person` и `Company`. 

```cypher
// Создание ролей
CREATE ROLE employee;
CREATE ROLE manager;

// Назначение прав роли 'employee'
GRANT READ ON NODE LABEL Person TO employee;
GRANT READ ON NODE LABEL Company TO employee;
GRANT READ ON RELATIONSHIP TYPE WORKS_AT TO employee;

// Назначение прав роли 'manager'
GRANT ALL ON NODE LABEL Person TO manager;
GRANT ALL ON NODE LABEL Company TO manager;
```

Теперь мы можем назначить эти роли различным пользователям. Например, пользователю `john` можно назначить роль `employee`, а пользователю `jane` - роль `manager`.

### Важные замечания

* Роли и права доступа можно использовать для создания гибкой системы управления доступом к данным.
* В Neo4j доступ к данным по умолчанию запрещен. Пользователи не имеют доступа к данным, пока им не будут назначены соответствующие роли и права.
* Для более детального управления доступом можно использовать права на уровне свойств. 
* При назначении прав и ролей следует учитывать безопасность и предотвращение несанкционированного доступа к данным.

### Дополнительные ресурсы

* [Документация Neo4j: Role Management](https://neo4j.com/docs/cypher-manual/current/administration/role-management/)
* [Руководство Neo4j: Безопасность](https://neo4j.com/docs/cypher-manual/current/administration/security/)
